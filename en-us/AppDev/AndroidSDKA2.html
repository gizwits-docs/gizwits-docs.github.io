
<!DOCTYPE html>
<html lang="en-us">
  <head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">

  <title>Guide to Gizwits Device SDK 2.0 for Android App - Gizwits</title>

  <meta http-equiv="X-UA-Compatible" content="IE=Edge, chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <meta name="Description" content="Guide to Gizwits Device SDK 2.0 for Android App-Gizwits">
  <meta name="keywords" content="Guide to Gizwits Device SDK 2.0 for Android App docs 文档中心 Gizwits">

  <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon">
  <script src="/js/redirect.js"></script>

  <link rel="stylesheet" href="/css/pure.min.css">
  <link rel="stylesheet" href="/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/documentation.css?v=db6111caa3d210b6cb1d2dac5119d7c5">
  <link rel="stylesheet" href="/css/share.min.css">
</head>
  <body>
    <div class="header">
  <div class="container pure-g">
    <span class="brand pure-u-5-24">
      <a href="http://www.gizwits.com" class="logo">
      
      <img src="/images/logo_en.png" alt="logo">
      
      </a>
      <a class="text" href="/">Docs</a>
    </span>

    <div class="mobile-header" v="">
      <span class="title">Gizwits Docs</span>
      <i class="fa fa-caret-square-o-down fa-lg" aria-hidden="true"></i>
    </div>

    <span class="menu pure-u-16-24">
      <span class="header-search-btn" id="header-search-btn">
        <i class="fa fa-search"></i>
      </span>
      <ul class="levelA-wrapper">
        
          
            <li class="levelA"><a href="/en-us/overview/overview.html">Overview</a></li>
          
        
          
            <li class="levelA">
              Quick Start &#9662;
              <ul class="levelB-wrapper">
                
                  
                    <li class="levelB"><a href="/en-us/AppDev/GizwitsQuickStart.html">Gizwits Quick Start within 5 mins</a></li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/quickstart/glossary.html">Glossary</a></li>
                  
                
              </ul>
            </li>
          
        
          
            <li class="levelA">
              App Dev Guide &#9662;
              <ul class="levelB-wrapper">
                
                  
                    <li class="levelB"><a href="/en-us/quickstart/AppDevGetStarted.html">Get Started with APP Development</a></li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/UserManual/devApp.html">App code auto-generator</a></li>
                  
                
                  
                    <li class="levelB has-submenu">
                      APP Frame Guide &#9656;
                      <ul class="levelC-wrapper">
                        
                          <li class="levelC"><a href="/en-us/AppDev/iOSPushNotification.html">iOS Push Notification</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/iOSAuthReSkin.html">iOS Auth Re Skin</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/iosframe.html">Quick start of iOS App development</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/androidframe.html">Android frame</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/AndroidPushNotification.html">Android Push Notification</a></li>
                        
                          <li class="levelC"><a href="/en-us/quickstart/AndroidAppFrame.html">Quick start of Android App development</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/APICloudFrame.html">API Cloud Frame</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/VideoTutorial.html">Video tutorial of the App open source framework</a></li>
                        
                      </ul>
                    </li>
                  
                
                  
                    <li class="levelB has-submenu">
                      App SDK Guide &#9656;
                      <ul class="levelC-wrapper">
                        
                          <li class="levelC"><a href="/en-us/AppDev/iOSSDKA2.html">iOS SDK</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/AndroidSDKA2.html">Android SDK</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/APICloudWifiSDK.html">APICloud SDK</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/SDKTransparentTransmission.html">Data transparent transmission of SDK</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/SDKLogCapture.html">SDK debug log capture</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/sdk_error.html">SDK error codes</a></li>
                        
                      </ul>
                    </li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/WechatDev/WeChatDev.html">WeChat SDK Guide</a></li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/WechatDev/WechatDevIntro.html">WeChat Dev Intro</a></li>
                  
                
                  
                    <li class="levelB has-submenu">
                      More Guide &#9656;
                      <ul class="levelC-wrapper">
                        
                          <li class="levelC"><a href="/en-us/cloud/SharingSDK.html">Gizwits Device Sharing</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/third-party.html">Application process for third-party authentication</a></li>
                        
                      </ul>
                    </li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/AppDev/AppDevFAQ.html">App Dev FAQ</a></li>
                  
                
              </ul>
            </li>
          
        
          
            <li class="levelA">
              DeviceDev &#9662;
              <ul class="levelB-wrapper">
                
                  
                    <li class="levelB"><a href="/en-us/DeviceDev/DeviceDevIntro.html">Get started with device connection</a></li>
                  
                
                  
                    <li class="levelB has-submenu">
                      Gizwits Cloud access &#9656;
                      <ul class="levelC-wrapper">
                        
                          <li class="levelC"><a href="/en-us/quickstart/UseMCU.html">MCU scheme</a></li>
                        
                          <li class="levelC"><a href="/en-us/DeviceDev/UseSOC.html">ESP8266-SoC scheme</a></li>
                        
                      </ul>
                    </li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/module_source/module_source.html">Module Documents</a></li>
                  
                
                  
                    <li class="levelB has-submenu">
                      GAgent Documents &#9656;
                      <ul class="levelC-wrapper">
                        
                          <li class="levelC"><a href="/en-us/DeviceDev/gagent_info.html">Detailed annotation of GAgent</a></li>
                        
                          <li class="levelC"><a href="/en-us/DeviceDev/DebugTool.html">Firmware downloading on modules</a></li>
                        
                          <li class="levelC"><a href="/en-us/DeviceDev/debug/HF-LPB100.html">HF-LPB100</a></li>
                        
                          <li class="levelC"><a href="/en-us/DeviceDev/debug/HF-LPT120.html">HF-LPT120</a></li>
                        
                          <li class="levelC"><a href="/en-us/DeviceDev/debug/MXCHIP.html">MXCHIP</a></li>
                        
                          <li class="levelC"><a href="/en-us/DeviceDev/debug/ESP8266.html">ESP8266</a></li>
                        
                      </ul>
                    </li>
                  
                
              </ul>
            </li>
          
        
          
            <li class="levelA">
              Cloud API &#9662;
              <ul class="levelB-wrapper">
                
                  
                    <li class="levelB"><a href="/en-us/cloud/OpenAPI.html">Open API</a></li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/cloud/ent_dev.html">Enterprise Application Development</a></li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/cloud/enterprise_api.html">Enterprise API</a></li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/cloud/NotificationAPI.html">Notification API</a></li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/cloud/WebsocketAPI.html">WebsocketAPI</a></li>
                  
                
                  
                    <li class="levelB has-submenu">
                      API Tutorial &#9656;
                      <ul class="levelC-wrapper">
                        
                          <li class="levelC"><a href="/en-us/UserManual/UseOpenAPI.html">Using Open API to control virtual device with Postman</a></li>
                        
                          <li class="levelC"><a href="/en-us/UserManual/UseSNoti.html">Real-time data synchronization demo for SNoti service</a></li>
                        
                          <li class="levelC"><a href="/en-us/UserManual/UseWebsocket.html">Control device using WebSocket</a></li>
                        
                          <li class="levelC"><a href="/en-us/UserManual/DataAPI.html">Aggregation API Guide</a></li>
                        
                          <li class="levelC"><a href="/en-us/UserManual/LinkageAPI.html">Device Linkage API Tutorial</a></li>
                        
                          <li class="levelC"><a href="/en-us/UserManual/devgroup_API.html">Device Grouping API Tutorial</a></li>
                        
                          <li class="levelC"><a href="/en-us/UserManual/UseQRCode.html">Generating device QR code for App binding</a></li>
                        
                      </ul>
                    </li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/cloud/CloudFAQ.html">Cloud FAQ</a></li>
                  
                
              </ul>
            </li>
          
        
          
            <li class="levelA">
              User Manual &#9662;
              <ul class="levelB-wrapper">
                
                  
                    <li class="levelB"><a href="/en-us/UserManual/ST_IoT.html">Gizwits and ST Make IoT Development Easy</a></li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/DeviceDev/ST/ICUBEGIZWITS.html">Getting Started with I-CUBE-GiZWITS</a></li>
                  
                
              </ul>
            </li>
          
        
      </ul>
    </span>

    <span class="pure-u-3-24 lang-switch-wrapper">

      <i class="fa fa-globe" aria-hidden="true"></i>
      
      <a href="/zh-cn/overview/overview.html" class="lang-switch" data-lang="zh-cn">中文</a>
      
    </span>
  </div>

  <div class="header-search-panel" id="header-search-panel">
    <span class="header-search-close" id="header-search-close"><i class="fa fa-times" aria-hidden="true"></i></span>
    <div class="header-search-input-wrap" id="header-search-input-wrap">
      <input type="text" class="header-search-input" id="header-search-input" placeholder="请输入关键字">
      <span class="header-search-input-icon"><i class="fa fa-search"></i></span>
    </div>

    <div class="header-search-trend" id="header-search-trend">
      <div class="header-search-trend-title">热搜词</div>
      <div class="header-search-trend-items clearfix">
        
        <div class="header-search-trend-item" data-word="APP">APP</div>
        
        <div class="header-search-trend-item" data-word="SDK">SDK</div>
        
        <div class="header-search-trend-item" data-word="Android">Android</div>
        
        <div class="header-search-trend-item" data-word="ios">ios</div>
        
        <div class="header-search-trend-item" data-word="WIFI">WIFI</div>
        
      </div>
    </div>

    <div class="header-search-result hidden" id="header-search-result">
      <div class="header-search-result-head">
        搜索结果 &gt; <span id="header-search-keyword"></span>
      </div>
      <div class="header-search-result-items" id="header-search-result-items">
      </div>
    </div>
  </div>
</div>

    <div class="body">

  <div class="container clearfix">
    <div class="navigation">
      <div class="navigation-inner">
        <div class="nav-title">Content</div>
        <div class="nav"></div>
      </div>
    </div>
    <div class="markdown-body" data-spy="scroll" data-target=".navigation">
      <div class="heading">
        <div class="title">Guide to Gizwits Device SDK 2.0 for Android App</div>
        <a class="edit-link" target="_blank"><i class="fa fa-github" aria-hidden="true"></i> Edit</a>
      </div>
      <h1 id="SDK-API-Reference-Manual"><a href="#SDK-API-Reference-Manual" class="headerlink" title="SDK_API Reference Manual"></a>SDK_API Reference Manual</h1><p>Attachment: Android_SDK2.0_API Reference Manual</p>
<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h1><h2 id="1-Objectives"><a href="#1-Objectives" class="headerlink" title="1. Objectives"></a>1. Objectives</h2><p>The Gizwits Device SDK (hereinafter referred to as the SDK) encapsulates the communication process between mobile phones (including PAD and other devices) and smart devices, and the communication process between mobile phones and Gizwits Cloud. These processes involve configuring network access, device discovery, connectivity, device control, heartbeat, status report, and alarm notification. Using the SDK, you only need to focus on the App UI/UE and are able to rapidly complete your App development, while ignoring the related issues such as complex protocols and error handling.<br>The SDK has been further simplified based on the definition of the new APIs, and its process is briefer. You have no need to understand the concept of device connectivity underneath at all.</p>
<h2 id="2-Gizwits-IoT-Architecture"><a href="#2-Gizwits-IoT-Architecture" class="headerlink" title="2. Gizwits IoT Architecture"></a>2. Gizwits IoT Architecture</h2><p><img src="../../../assets/en-us/AppDev/AndroidSDK/11.png" alt="Gizwits Device SDK"></p>
<h2 id="3-Choose-the-right-SDK"><a href="#3-Choose-the-right-SDK" class="headerlink" title="3. Choose the right SDK"></a>3. Choose the right SDK</h2><p>Gizwits currently offers three types of SDKs: the native Device SDK for iOS, the native Device SDK for Android, and the cross-platform APICloud SDK. you can choose any one of those SDKs that best aligns with your desired scenario and customize as needed. The APICloud SDK can be developed once with HTML5 and adapt to both iOS and Android. For details, please refer to Guide of Gizwits Device SDK for APICloud.</p>
<h2 id="4-Term-definitions"><a href="#4-Term-definitions" class="headerlink" title="4. Term definitions"></a>4. Term definitions</h2><h3 id="4-1-GAgent"><a href="#4-1-GAgent" class="headerlink" title="4.1 GAgent"></a>4.1 GAgent</h3><p>The full name is Gizwits Agent, which runs on Wi-Fi modules, and through which devices access the Gizwits server. Currently, it is compatible with mainstream Wi-Fi modules of China. Developers can also implement their own custom modules to access Gizwits using the GAgent secondary development package provided by Gizwits.</p>
<h3 id="4-2-Micro-Cycle"><a href="#4-2-Micro-Cycle" class="headerlink" title="4.2 Micro Cycle"></a>4.2 Micro Cycle</h3><p>Connections between smart devices and mobile phones, smart devices and smart devices via the same router to achieve WLAN communication (status check or control), which is called a Micro Cycle.</p>
<h3 id="4-3-Macro-Cycle"><a href="#4-3-Macro-Cycle" class="headerlink" title="4.3 Macro Cycle"></a>4.3 Macro Cycle</h3><p>Smart devices access the Internet via routers to accomplish remote monitoring and control by users, which is called a Macro Cycle.</p>
<h3 id="4-4-ProductKey"><a href="#4-4-ProductKey" class="headerlink" title="4.4 ProductKey"></a>4.4 ProductKey</h3><p>Product identification code, a 32 characters long string that is automatically generated by the developer after creating a new product in Gizwits cloud. It is a unique code in the database of Gizwits cloud. After the developer writes the ProductKey to the device master MCU, the Gizwits identifies the device through this code and automatically completes the registration.</p>
<h3 id="4-5-DID"><a href="#4-5-DID" class="headerlink" title="4.5 DID"></a>4.5 DID</h3><p>Device code. When a device is connected to Gizwits for the first time, Gizwits automatically generates a DID for the device based on its ProductKey and Wi-Fi module MAC address. DID which is used to associate with users and perform subsequent operations, should be unique across the entire network.</p>
<h3 id="4-6-PassCode"><a href="#4-6-PassCode" class="headerlink" title="4.6 PassCode"></a>4.6 PassCode</h3><p>Device Pass Code, used to verify the user’s binding/control permission. When the user initiates a device binding, the device pass code can be obtained by users with legal means to bind the device and perform operations such as device status check and control during the valid period. GAgent generates a random number as a device pass when it is first run. It is generated and stored in non-volatile memory. When the device goes online, it needs to be reported to the server.</p>
<h3 id="4-7-AppID"><a href="#4-7-AppID" class="headerlink" title="4.7 AppID"></a>4.7 AppID</h3><p>Application identification code. When you need to develop an application (including iOS, Android, Web application, etc.) for a smart device, an AppID is automatically generated in Gizwits cloud and associated with the device. This AppID is required for application development.</p>
<h3 id="4-8-Onboarding"><a href="#4-8-Onboarding" class="headerlink" title="4.8 Onboarding"></a>4.8 Onboarding</h3><p>Network access configuration, the process of connecting a Wi-Fi-based IoT device to a router is called Onboarding. When the new device is used for the first time, it needs to know the router’s SSID and password to connect to the Internet via the router. Since most IoT devices do not have their own screens and keyboards, it is necessary to send the router’s SSID and password to the device through a smart phone. The network access SDK for Wi-Fi devices provided by Gizwits has such built-in configuration function.</p>
<h3 id="4-9-AirLink"><a href="#4-9-AirLink" class="headerlink" title="4.9 AirLink"></a>4.9 AirLink</h3><p>Collectively, the features of UDP broadcast messages that allow you to configure the network access for devices, such as SmartConfig and SmartLink, are called AirLink. It provides the standard onboarding operation procedures with a good user experience, which is compatible with configuration protocols from multiple Wi-Fi module manufacturers. The network access SDK for Wi-Fi devices provided by Gizwits has built-in AirLink function. </p>
<h3 id="4-10-SoftAP"><a href="#4-10-SoftAP" class="headerlink" title="4.10 SoftAP"></a>4.10 SoftAP</h3><p>Because each Smart Config protocol from different Wi-Fi module manufacturers is not fully mature and neither does it support 5G router signal. Gizwits has provided AirLink configuration mode and also supports SoftAP mode to configure devices to access routers. When a device enters the SoftAP configuration mode, the device itself becomes an AP, and the smart phone can directly connect to the device. Then the SSID and password of the router are input on the mobile phone and sent to the device which will automatically switch to the normal mode and try to connect to the router.</p>
<h2 id="5-Integration-preparation"><a href="#5-Integration-preparation" class="headerlink" title="5. Integration preparation"></a>5. Integration preparation</h2><h3 id="5-1-Register-a-Gizwits-developer-account"><a href="#5-1-Register-a-Gizwits-developer-account" class="headerlink" title="5.1 Register a Gizwits developer account"></a>5.1 Register a Gizwits developer account</h3><p>Before using Gizwits services, you need to sign up for a developer account on site.gizwits.com. Please refer to Quick Start to complete your registration.</p>
<h3 id="5-2-Create-device-connection"><a href="#5-2-Create-device-connection" class="headerlink" title="5.2 Create device connection"></a>5.2 Create device connection</h3><p>For this section, please refer to Quick Start.</p>
<h3 id="5-3-Get-App-ID-and-product-identification-code-productkey"><a href="#5-3-Get-App-ID-and-product-identification-code-productkey" class="headerlink" title="5.3 Get App ID and product identification code (productkey)"></a>5.3 Get App ID and product identification code (productkey)</h3><p>For this section, please refer to Quick Start.</p>
<h3 id="5-4-Download-the-SDK"><a href="#5-4-Download-the-SDK" class="headerlink" title="5.4 Download the SDK"></a>5.4 Download the SDK</h3><p><img src="../../../assets/en-us/AppDev/AndroidSDK/12.png" alt="Gizwits Device SDK"></p>
<h3 id="5-5-Import-the-SDK"><a href="#5-5-Import-the-SDK" class="headerlink" title="5.5 Import the SDK"></a>5.5 Import the SDK</h3><p>Step 1: Double-click to unzip GizWifiSDK-Android-xxx.zip.</p>
<p>Step 2: Copy all the files in the decompressed libs directory to the libs directory of the specified project, and ensure that the files in the red box below are loaded into the project:</p>
<p><img src="../../../assets/en-us/AppDev/AndroidSDK/13.png" alt="Gizwits Device SDK"></p>
<h3 id="5-6-Update-AndroidManifest-xml"><a href="#5-6-Update-AndroidManifest-xml" class="headerlink" title="5.6 Update AndroidManifest.xml"></a>5.6 Update AndroidManifest.xml</h3><p>Copy the following permission configuration code snippet into the AndroidManifest.xml file:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot; /&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.ACCESS_WIFI_STATE&quot; /&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.READ_PHONE_STATE&quot; /&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.ACCESS_COARSE_LOCATION&quot; /&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.ACCESS_FINE_LOCATION&quot; /&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot; /&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.CHANGE_WIFI_STATE&quot; /&gt;</span><br><span class="line">&lt;uses-permission android:name=&quot;android.permission.CHANGE_WIFI_MULTICAST_STATE&quot; /&gt;</span><br></pre></td></tr></table></figure>
<p>Note:</p>
<table>
<thead>
<tr>
<th>Permission</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>ACCESS_NETWORK_STATE</td>
<td>Allows applications to access information about networks.</td>
</tr>
<tr>
<td>ACCESS_WIFI_STATE</td>
<td>Allows applications to access information about Wi-Fi networks.</td>
</tr>
<tr>
<td>READ_PHONE_STATE</td>
<td>Allows read only access to phone state, including the phone number of the device, current cellular network information, the status of any ongoing calls, and a list of any PhoneAccounts registered on the device.</td>
</tr>
<tr>
<td>ACCESS_COARSE_LOCATION</td>
<td>Allows an app to access approximate location for CellID or WiFi hotspots.</td>
</tr>
<tr>
<td>ACCESS_FINE_LOCATION</td>
<td>Allows an app to access precise location.  (such as GPRS)</td>
</tr>
<tr>
<td>WRITE_EXTERNAL_STORAGE</td>
<td>Allows an application to write to external storage like SD card.</td>
</tr>
<tr>
<td>INTERNET</td>
<td>Allows applications to open network sockets.</td>
</tr>
<tr>
<td>CHANGE_WIFI_STATE</td>
<td>Allows applications to change Wi-Fi connectivity state.</td>
</tr>
<tr>
<td>CHANGE_WIFI_MULTICAST_STATE</td>
<td>Allows applications to enter Wi-Fi Multicast mode.</td>
</tr>
</tbody>
</table>
<h3 id="5-7-Read-and-write-permission-settings-for-Android-6-0-system-files"><a href="#5-7-Read-and-write-permission-settings-for-Android-6-0-system-files" class="headerlink" title="5.7 Read and write permission settings for Android 6.0 system files"></a>5.7 Read and write permission settings for Android 6.0 system files</h3><p>Android 6.0 has added the new feature of runtime permission dynamic check. The following permission used in GizWifiSDK need to be detemined at runtime: ACCESS_FINE_LOCATION, which can detect the current Wi-Fi networks and connectable Wi-Fi network list of for the mobile phone.</p>
<p>Here’s an example of how to write dynamic check code with this permission request:</p>
<p>The Android 6.0 grants all the permissions requested for the application with targetSdkVersion less than 23 by default, so if the targetSdkVersion used by the App is lower than 23, it can run normally. However, if the user cancels the granted permission in the settings, or the targetSdkVersion used by the App is 23 or higher, it needs to be solved in the App code. The following is an example with Android Studio:</p>
<ul>
<li>Target SDK version</li>
</ul>
<p>Set targetSdkVersion to 23 in build.gradle:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">	compileSdkVersion 23</span><br><span class="line">	buildToolsVersion &quot;23.0.1&quot;</span><br><span class="line">	defaultConfig &#123;</span><br><span class="line">		applicationId &quot;com.yourcomany.app     </span><br><span class="line">		minSdkVersion 18     </span><br><span class="line">		targetSdkVersion 23     </span><br><span class="line">		versionCode 1     </span><br><span class="line">		versionName &quot;1.0&quot;</span><br><span class="line">	&#125;</span><br><span class="line">	buildTypes &#123;</span><br><span class="line">		release &#123;</span><br><span class="line">			minifyEnabled false</span><br><span class="line">			proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Check and request the permission</li>
</ul>
<p>Check if the App already has ACCESS_FINE_LOCATION permission, if not, request the permission:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(ContextCompat.checkSelfPermission(this, Manifest.permission.ACCESS_FINE_LOCATION) != PackageManager.PERMISSION_GRANTED) &#123;          </span><br><span class="line">	ActivityCompat.requestPermissions(this, new String[] &#123; Manifest.permission.ACCESS_FINE_LOCATION &#125;, ACCESS_FINE_LOCATION_REQUEST_CODE);      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>After requesting the permission, the system will pop up a dialog box asking for the permission:</li>
</ul>
<p><img src="../../../assets/en-us/AppDev/AndroidSDK/14.jpg" alt="Gizwits Device SDK"></p>
<ul>
<li>After the user chooses Allow, the onRequestPermissionsResult method will be called back. This method can be handled like this:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">onActivityResult  </span><br><span class="line">Override  </span><br><span class="line">public void onRequestPermissionsResult(int requestCode, String[] permissions, int[] grantResults) &#123;      </span><br><span class="line">	super.onRequestPermissionsResult(requestCode, permissions, grantResults);      </span><br><span class="line">	doNext(requestCode,grantResults);  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Then follow the requestCode and grantResults (authorization results) for subsequent processing</span><br><span class="line">private void doNext(int requestCode, int[] grantResults) &#123;</span><br><span class="line">	if (requestCode == ACCESS_FINE_LOCATION_REQUEST_CODE) &#123;</span><br><span class="line">		if (grantResults[0] == PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">              		// Permission Granted          </span><br><span class="line">		&#125; else &#123;</span><br><span class="line">              		// Permission Denied</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Special handling for runtime permissions in Fragment</p>
<ul>
<li>For permission request in Fragment, do not use ActivityCompat.requestPermissions, directly use Fragment’s requestPermissions method, otherwise it will callback Activity onRequestPermissionsResult</li>
<li>If nesting Fragment in Fragment, use requestPermissions method in the child Fragment, onRequestPermissionsResult will not be called back. It is recommended to use getParentFragment().requestPermissions method. This method will call back the onRequestPermissionsResult of the parent Fragment, and add the following code snippet to the callback method to pass the callback to the child Fragment:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Override  </span><br><span class="line">public void onRequestPermissionsResult(int requestCode, String[] permissions, int[] grantResults) &#123;</span><br><span class="line">	super.onRequestPermissionsResult(requestCode, permissions, grantResults);</span><br><span class="line">	List&lt;Fragment&gt; fragments = getChildFragmentManager().getFragments();      </span><br><span class="line">	if (fragments != null) &#123;</span><br><span class="line">		for (Fragment fragment : fragments) &#123;</span><br><span class="line">			if (fragment != null) &#123;</span><br><span class="line">				fragment.onRequestPermissionsResult(requestCode,permissions,grantResults);    </span><br><span class="line">			&#125;          </span><br><span class="line">  		&#125;      </span><br><span class="line"> 	&#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5-8-How-to-use-GizWifiSDK-with-Android-Studio"><a href="#5-8-How-to-use-GizWifiSDK-with-Android-Studio" class="headerlink" title="5.8 How to use GizWifiSDK with Android Studio"></a>5.8 How to use GizWifiSDK with Android Studio</h3><p>Step 1, download sdk here.</p>
<p>Please unzip the file after the download is complete.</p>
<p><img src="../../../assets/en-us/AppDev/AndroidSDK/15.png" alt="Gizwits Device SDK"></p>
<p>Step 2, import the jar package in Android Studio.</p>
<p><img src="../../../assets/en-us/AppDev/AndroidSDK/16.png" alt="Gizwits Device SDK"></p>
<p>Step 3, add the jar files as libraries.</p>
<p><img src="../../../assets/en-us/AppDev/AndroidSDK/17.png" alt="Gizwits Device SDK"></p>
<p>Step 4, import the so files.</p>
<p>Please create the folder jniLibs under the main folder and paste armeabi into the created folder:</p>
<p><img src="../../../assets/en-us/AppDev/AndroidSDK/18.png" alt="Gizwits Device SDK"></p>
<p>Step 5, after the import is completed, check the corresponding build.gradle</p>
<p>In the figure below, you can see the associated library:</p>
<p><img src="../../../assets/en-us/AppDev/AndroidSDK/19.png" alt="Gizwits Device SDK"></p>
<p>Step 6, test if it is successful.</p>
<p><img src="../../../assets/en-us/AppDev/AndroidSDK/20.png" alt="Gizwits Device SDK"></p>
<p>If there is a log in the picture below, it means success:</p>
<p><img src="../../../assets/en-us/AppDev/AndroidSDK/29.png" alt="Gizwits Device SDK"></p>
<h1 id="The-SDK-workflow"><a href="#The-SDK-workflow" class="headerlink" title="The SDK workflow"></a>The SDK workflow</h1><h2 id="1-General-flow-chart"><a href="#1-General-flow-chart" class="headerlink" title="1. General flow chart"></a>1. General flow chart</h2><p><img src="../../../assets/en-us/AppDev/AndroidSDK/21.png" alt="Gizwits Device SDK"></p>
<h2 id="2-Key-point-description"><a href="#2-Key-point-description" class="headerlink" title="2. Key point description"></a>2. Key point description</h2><p>1) The SDK has encapsulated all the activities related to user, configuration, discovery, connection, and control. You can use these APIs to develop the functions in the above flow chart without having to implement the communication protocol by yourself.</p>
<p>2) The SDK adopts the callback method, so it is necessary to set up necessary delegates, such as the common delegate and the device delegates. For more information, please refer to the detailed workflow. The SDK calls the App in the main thread.</p>
<p>3) The SDK supports Applications to transfer objects between Activities and between Activity and Service.</p>
<ul>
<li>You can use intent to pass objects between Activities.</li>
</ul>
<p>(Send)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Intent intent = new Intent(Context, A.class);</span><br><span class="line">	Bundle bundle = new Bundle();</span><br><span class="line">	bundle.putParcelable(&quot;parameter name&quot;, device type object);</span><br><span class="line">	intent.putExtras(bundle);</span><br><span class="line">	startActivity(intent);</span><br></pre></td></tr></table></figure>
<p>(Receive)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Intent intent = getIntent();</span><br><span class="line">	intent.getParcelableExtra(&quot;parameter name&quot;);</span><br></pre></td></tr></table></figure>
<ul>
<li>For passing objects between activity and service, it can be achieved by broadcast. One party sends data and the other party receives it.</li>
</ul>
<p>(Register broadcast receiver)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">IntentFilter filter = new IntentFilter();// Create IntentFilter object</span><br><span class="line">	//Register a broadcast receiver to receive commands sent by the Activity to control the behaviors of the Service, such as: sending data, stopping services, etc.</span><br><span class="line">	filter.addAction(&quot;AAAAAAA&quot;);</span><br><span class="line">	//Register Broadcast Receiver</span><br><span class="line">	registerReceiver(cmdReceiver, filter);</span><br></pre></td></tr></table></figure>
<p>(Send broadcast)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Intent intent = new Intent();  </span><br><span class="line">	intent.setAction(&quot;AAAAAAA&quot;);  </span><br><span class="line">	Bundle bundle = new Bundle();</span><br><span class="line">	bundle.putParcelable(&quot;parameter name&quot;,  device type object);</span><br><span class="line">	intent.putExtras(bundle);</span><br><span class="line">	sendOrderedBroadcast(intent, null);</span><br></pre></td></tr></table></figure>
<ul>
<li>Obtain the Service object in the Activity via bindService, and directly call the Service method to get the desired device object.</li>
</ul>
<h2 id="3-Key-point-description"><a href="#3-Key-point-description" class="headerlink" title="3. Key point description"></a>3. Key point description</h2><p>If your project uses Proguard obfuscation, in order to avoid the SDK being confused twice and the SDK cannot be used normally, be sure to add the following code snippet into proguard-project.txt:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-libraryjars libs/GizWifiSDK.jar</span><br><span class="line">-dontwarn com.gizwits.**</span><br><span class="line">-keep class com.gizwits.**&#123;</span><br><span class="line">    *;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>And refer to the Android obfuscation file in project.properties:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proguard.config=$&#123;sdk.dir&#125;/tools/proguard/proguard-android.txt:proguard-project.txt</span><br></pre></td></tr></table></figure>
<h1 id="Detailed-workflow-of-the-SDK"><a href="#Detailed-workflow-of-the-SDK" class="headerlink" title="Detailed workflow of the SDK"></a>Detailed workflow of the SDK</h1><h2 id="1-Initialization"><a href="#1-Initialization" class="headerlink" title="1. Initialization"></a>1. Initialization</h2><h3 id="1-1-Flow-chart"><a href="#1-1-Flow-chart" class="headerlink" title="1.1 Flow chart"></a>1.1 Flow chart</h3><p><img src="../../../assets/en-us/AppDev/AndroidSDK/22.png" alt="Gizwits Device SDK"></p>
<h3 id="1-2-Set-up-the-common-listener"><a href="#1-2-Set-up-the-common-listener" class="headerlink" title="1.2 Set up the common listener"></a>1.2 Set up the common listener</h3><p>Registering the common listener for the SDK is to enable the App to receive events from GizWifiSDK class, which involves the callback interfaces such as registration, login, device configuration, and device binding. This is a very important listener in the use of the SDK, where the operations related to GizWifiSDK class will be called back. If the common listener is not properly registered, the SDK will not work normally. When registering the listener, you can implement callback interfaces on your behalf.</p>
<p>There are two recommended ways:</p>
<p>1) Instantiate a listener and register it once in each used Activity, and only implement the required callback interface. This method is more flexible and can be used in the service. But ensure that every time you start the activity you must register the listener, and multiple Activities cannot receive the callback at the same time.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// Instantiate a listener</span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line"></span><br><span class="line">// Callback for user registration with mobile phone</span><br><span class="line">Override</span><br><span class="line">public void didRegisterUser(GizWifiErrorCode result, String uid, String token)&#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">public void onCreate() &#123;</span><br><span class="line">super.onCreate();</span><br><span class="line"></span><br><span class="line">// Register the listener</span><br><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">// Call the SDK interface for user registration with mobile phone</span><br><span class="line">GizWifiSDK.sharedInstance().registerUser(&quot;HelloGizwits&quot;, &quot;12345678&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>2) Instantiate a listener in a base class and throw the callback. The subclass inherits the base class, which eliminates the need for each subclass to instantiate the listener. In this way, by inheritance, multiple Activities can receive the callback. But this method cannot be used in the Service. Except where otherwise noted, the examples in this documentation use this method to register the listener.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">// Create a base class that instantiates and registers the listener</span><br><span class="line">public class BaseActivity extends Activity &#123;</span><br><span class="line">private GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">Override</span><br><span class="line">public void didRegisterUser(GizWifiErrorCode result, String uid, String token) &#123;</span><br><span class="line">BaseActivity.this.didRegisterUser(result, uid, token);</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">public void didRegisterUser(GizWifiErrorCode result, String uid, String token)</span><br><span class="line">&#123;</span><br><span class="line">// to do</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Override</span><br><span class="line">protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">super.onCreate(savedInstanceState);</span><br><span class="line"></span><br><span class="line">//Every time you start the activity, you must register the SDK listener to ensure that the SDK state can be passed into the callback correctly.</span><br><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//The subclass inherits the base class and implements the callback interface of the base class.</span><br><span class="line">public class TestActivity extends BaseActivity &#123;</span><br><span class="line">    protected void onCreate(android.os.Bundle savedInstanceState) &#123;</span><br><span class="line">        //Call the parent class method</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        //Call the method for user registration </span><br><span class="line">GizWifiSDK.sharedInstance().registerUser (&quot;your_phone_number&quot;, &quot;your_ password&quot;, “your_verify_code”, GizUserAccountType.GizUserPhone);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public void didRegisterUser(GizWifiErrorCode result, String uid,  String token) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1-3-Initialize-the-SDK"><a href="#1-3-Initialize-the-SDK" class="headerlink" title="1.3 Initialize the SDK"></a>1.3 Initialize the SDK</h3><p>Before the SDK is launched, any feature is not working properly. When the SDK starts, it will be initialized and automatically discover devices in the current LAN. The SDK will report the discovered devices and corresponding events through the common listener. You can set the SDK’s common listener first, then launch the SDK so as to handle these events.</p>
<p>When the SDK starts, the App AppID needs to be specified. You should apply for an AppID for your own App in the Gizwits Developer Center. Please call the method in the App Application or the onCreate of the first started Activity with the specified AppID. This method only needs to be called once.</p>
<p>The SDK’s log can help you discover issues that occur while the App is running. By default, the SDK outputs all log information to the debug terminal and log files. If the phone has an SD card, the log file will be saved on the SD card. If there is no SD card, it will only be saved in the application path. The log file directory on the SD card is GizWifiSDK/app_package_name/GizSDKLog under the path of the mobile phone SD card. If you do not want to output logs in the debugging terminal, you can change the log output level to GizLogPrintNone.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">public void onCreate() &#123;</span><br><span class="line">super.onCreate();</span><br><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">GizWifiSDK.sharedInstance().startWithAppID(getApplicationContext(), &quot;your_app_id&quot;);</span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void didNotifyEvent(GizEventType eventType, Object eventSource, GizWifiErrorCode eventID, String eventMessage) &#123;</span><br><span class="line">if (eventType == GizEventType.GizEventSDK) &#123;</span><br><span class="line">// SDK event notification</span><br><span class="line">	    		Log.i(&quot;GizWifiSDK&quot;, &quot;SDK event happened: &quot; + eventID + &quot;, &quot; + eventMessage);</span><br><span class="line">&#125; else if (eventType == GizEventType.GizEventDevice) &#123;</span><br><span class="line">	    		// Notification that may occur when the device is disconnected</span><br><span class="line">	    		GizWifiDevice mDevice = (GizWifiDevice)eventSource;</span><br><span class="line">	    		Log.i(&quot;GizWifiSDK&quot;, &quot;device mac: &quot; + mDevice.getMacAddress() + &quot; disconnect caused by eventID: &quot; + eventID + &quot;, eventMessage: &quot; + eventMessage);</span><br><span class="line">&#125; else if (eventType == GizEventType.GizEventM2MService) &#123;</span><br><span class="line">	    		// Notification for the M2M service exception</span><br><span class="line">	    		Log.i(&quot;GizWifiSDK&quot;, &quot;M2M domain &quot; + (String)eventSource + &quot; exception happened, eventID: &quot; + eventID + &quot;, eventMessage: &quot; + eventMessage);</span><br><span class="line">&#125; else if (eventType == GizEventType.GizEventToken) &#123;</span><br><span class="line">	    		// Notification for invalid token</span><br><span class="line">	    		Log.i(&quot;GizWifiSDK&quot;, &quot;token &quot; + (String)eventSource + &quot; expired: &quot; + eventMessage);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="2-User-Management"><a href="#2-User-Management" class="headerlink" title="2. User Management"></a>2. User Management</h2><p>The user management of Gizwits Cloud includes functions such as user registration, login, password recovery, and personal information modification. Gizwits Cloud distinguishes users by APPID, and the users with different APPIDs are independent of each other. After changing the APPID of a user, you need to re-register the user.<br>The listener registration method involved in the following process is implemented using class inheritance.</p>
<h3 id="2-1-Flow-chart"><a href="#2-1-Flow-chart" class="headerlink" title="2.1 Flow chart"></a>2.1 Flow chart</h3><p><img src="../../../assets/en-us/AppDev/AndroidSDK/23.png" alt="Gizwits Device SDK"></p>
<p>There are many ways for users to register, such as mobile phone number, user name, email address, etc. The App can take the method as needed. For other processes such as login, password change, personal information modification, etc., see the following section.</p>
<h3 id="2-2-User-registration"><a href="#2-2-User-registration" class="headerlink" title="2.2 User registration"></a>2.2 User registration</h3><p>Gizwits provides three user registration methods, such as register via mobile phone, regular user registration, and register via Email.</p>
<h4 id="2-2-1-Register-as-a-mobile-phone-user"><a href="#2-2-1-Register-as-a-mobile-phone-user" class="headerlink" title="2.2.1 Register as a mobile phone user"></a>2.2.1 Register as a mobile phone user</h4><p>To register an account with your mobile phone, you need a valid mobile phone number. Two steps are required for registration: get the SMS verification code and register the user with the SMS verification code.</p>
<p>Step 1: get the SMS verification code. The SDK sends a SMS verification code request to the cloud. If the request is successful, the cloud will respond a SMS verification code to the mobile phone.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">GizWifiSDK.sharedInstance().requestSendPhoneSMSCode (&quot;your_app_secret&quot;, &quot;your_phone_number&quot;);</span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void didRequestSendPhoneSMSCode(GizWifiErrorCode result, String token) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Step 2: Register with SMS verification code. The App passes the SMS verification code received by the mobile phone to the SDK, and fills in the mobile phone number and password to register.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">GizWifiSDK.sharedInstance().registerUser(&quot;your_phone_number&quot;, &quot;your_password&quot;, &quot;your_verify_code&quot;, GizUserAccountType.GizUserPhone);</span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void didRegisterUser(GizWifiErrorCode result, String uid,  String token) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-2-2-Register-as-a-regular-user"><a href="#2-2-2-Register-as-a-regular-user" class="headerlink" title="2.2.2 Register as a regular user"></a>2.2.2 Register as a regular user</h4><p>Register as a regular user account with a username and a password.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">GizWifiSDK.sharedInstance().registerUser(&quot;your_user_name&quot;, &quot;your_password&quot;, null, GizUserAccountType.GizUserNormal);</span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void didRegisterUser(GizWifiErrorCode result, String uid,  String token) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-2-3-Register-as-an-Email-user"><a href="#2-2-3-Register-as-an-Email-user" class="headerlink" title="2.2.3 Register as an Email user"></a>2.2.3 Register as an Email user</h4><p>Register a user account with a valid email address. After the registration is successful, the cloud will send an Email of the successful registration to the specified Email address.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">GizWifiSDK.sharedInstance().registerUser(&quot;your_email_address&quot;, &quot;your_password&quot;, null, GizUserAccountType.GizUserEmail);</span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void didRegisterUser(GizWifiErrorCode result, String uid,  String token) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-3-User-login"><a href="#2-3-User-login" class="headerlink" title="2.3 User login"></a>2.3 User login</h3><p>Gizwits Cloud provides three user login methods: real-name login, anonymous login, and third-party authentication. Real-name login is suitable for those Apps which have login UI and need to register before use. Anonymous login is applicable to the Apps that do not have login UI and user accounts are automatically generated in the cloud when needed. The token obtained after login is valid in 7 days.</p>
<h4 id="2-3-1-Real-name-login"><a href="#2-3-1-Real-name-login" class="headerlink" title="2.3.1 Real-name login"></a>2.3.1 Real-name login</h4><p>For real-name login, the user name can be the registered mobile phone number, Email address, and regular user name. If the AppID is changed, the user account needs to be re-registered.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">GizWifiSDK.sharedInstance().userLogin(&quot;your_user_name&quot;, &quot;your_password&quot;);</span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public  void didUserLogin(GizWifiErrorCode result, String uid,  String token) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-3-2-Anonymous-login"><a href="#2-3-2-Anonymous-login" class="headerlink" title="2.3.2 Anonymous login"></a>2.3.2 Anonymous login</h4><p>Every time a user logs in anonymously, the obtained uid is the same. The SDK uses the Android ID to generate a login account. Each Android system has a separate Android ID, which will change after the system is flashed. Therefore, the anonymously logged in user information cannot be retained after the system is flashed.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">GizWifiSDK.sharedInstance().userLoginAnonymous();</span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public  void didUserLogin(GizWifiErrorCode result, String uid,  String token) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-3-3-Third-party-authentication"><a href="#2-3-3-Third-party-authentication" class="headerlink" title="2.3.3 Third-party authentication"></a>2.3.3 Third-party authentication</h4><p>Gizwit Cloud currently supports third-party authentication from Baidu, Sina, and Tencent. You can use the APIs of these three platforms to obtain uid and token to log into Gizwits Cloud. When using third-party authentication, you do not need to register on Gizwits Cloud, you can log in directly.</p>
<p>You can get uid and token through those APIs of Sina, Baidu or Tencent. For details, please refer to the corresponding development documentation. </p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// Take the Sina account as example</span><br><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">GizWifiSDK.sharedInstance().loginWithThirdAccount(GizThirdAccountType.GizThirdSINA, &quot;your_third_uid&quot;, &quot;your_third_token&quot;);</span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public  void didUserLogin(GizWifiErrorCode result, String uid,  String token) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-4-Password-reset"><a href="#2-4-Password-reset" class="headerlink" title="2.4 Password reset"></a>2.4 Password reset</h3><p>If you have forgotten your password, you can set a new password via mobile phone or Email, which are supported by the SDK. For the password reset via mobile phone, the verification code will sent to your mobile phone. For the password reset via Email, there will be a hyperlink delivered to your Email address which prompts you to complete the rest steps.</p>
<h4 id="2-4-1-Password-reset-via-mobile-phone"><a href="#2-4-1-Password-reset-via-mobile-phone" class="headerlink" title="2.4.1 Password reset via mobile phone"></a>2.4.1 Password reset via mobile phone</h4><p>For the password reset via mobile phone, you need to get the SMS verification code. The approach of obtaining the SMS verification code is the same as when you registered with your mobile phone.</p>
<p>Step 1: get SMS verification code</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">GizWifiSDK.sharedInstance().requestSendPhoneSMSCode(&quot;your_app_secret&quot;, &quot;your_phone_number&quot;);</span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void didRequestSendPhoneSMSCode(GizWifiErrorCode result, String token) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Step 2: Reset your password with SMS verification code</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">GizWifiSDK.sharedInstance().resetPassword(&quot;your_phone_number&quot;, &quot;your_verify_code&quot;, &quot;your_new_password&quot;, GizUserAccountType.GizUserPhone);</span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public  void didChangeUserPassword(GizWifiErrorCode result) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-4-2-Password-reset-via-Email"><a href="#2-4-2-Password-reset-via-Email" class="headerlink" title="2.4.2 Password reset via Email"></a>2.4.2 Password reset via Email</h4><p>For the password reset via Email, the cloud sends a secure link to the specified Email address. You needs to check the Email in the mailbox and follow the instructions to perform the reset operation. It is possible that the password reset link is delivered into the trash folder of your mailbox, which you needs to be aware of.</p>
<p>The callback for the successful Email delivery is the same with the callback for the password change, so it is necessary to notice the distinction between these two cases.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">GizWifiSDK.sharedInstance().resetPassword(&quot;your_email_address&quot;, null, &quot;your_new_password&quot;, GizUserAccountType.GizUserEmail);</span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public  void didChangeUserPassword(GizWifiErrorCode result) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">        		//The reset password email is sent successfully, prompting the user to check</span><br><span class="line">&#125; else &#123;</span><br><span class="line">        		//The reset password email failed to send, an error message pops up</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-5-Password-change"><a href="#2-5-Password-change" class="headerlink" title="2.5 Password change"></a>2.5 Password change</h3><p>The password can be changed after you log in.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">GizWifiSDK.sharedInstance().changeUserPassword(&quot;your_token&quot;, &quot;your_old_password&quot;, &quot;your_new_password&quot;);</span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public  void didChangeUserPassword(GizWifiErrorCode result) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-6-User-type-conversion"><a href="#2-6-User-type-conversion" class="headerlink" title="2.6 User type conversion"></a>2.6 User type conversion</h3><p>An anonymous user can be converted to a real-name user, such as a regular user or a user registered with mobile phone. After the conversion, the anonymous user’s information will be transferred to the real-name user, and the original anonymous user account will be invalid. However, the user name or the mobile phone number of the target user must be unregistered before conversion, otherwise it will fail.</p>
<h4 id="2-6-1-An-anonymous-user-converted-to-a-regular-user"><a href="#2-6-1-An-anonymous-user-converted-to-a-regular-user" class="headerlink" title="2.6.1 An anonymous user converted to a regular user"></a>2.6.1 An anonymous user converted to a regular user</h4><p>For an anonymous user converted to a regular user, fill in the username, password, and token of the target regular user.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// An anonymous user converted to a regular user</span><br><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">GizWifiSDK.sharedInstance().transAnonymousUser(&quot;your_token&quot;, &quot;your_user_name&quot;, &quot;your_password&quot;, null, GizUserAccountType.GizUserNormal);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public  void didTransAnonymousUser(GizWifiErrorCode result) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-6-2-An-anonymous-user-converted-to-a-user-registered-with-mobile-phone"><a href="#2-6-2-An-anonymous-user-converted-to-a-user-registered-with-mobile-phone" class="headerlink" title="2.6.2 An anonymous user converted to a user registered with mobile phone"></a>2.6.2 An anonymous user converted to a user registered with mobile phone</h4><p>For an anonymous user converted to a mobile phone user, fill in the mobile phone number, password, SMS verification code, and token of the target user registered with mobile phone. The procedure of obtaining the SMS verification code is the same as when registering as a mobile phone user.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// An anonymous user converted to a user registered with mobile phone</span><br><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">GizWifiSDK.sharedInstance().transAnonymousUser(&quot;your_token&quot;, &quot;your_phone_number&quot;, &quot;your_password&quot;, &quot;your_verify_code&quot;, GizUserAccountType. GizUserPhone);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public  void didTransAnonymousUser(GizWifiErrorCode result) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-7-Update-user-information"><a href="#2-7-Update-user-information" class="headerlink" title="2.7 Update user information"></a>2.7 Update user information</h3><p>For real-name users, Gizwis does not support the regular user name modification. But you can modify the Email address and mobile phone number, supplement personal information after logging in, and the Email address or mobile phone number to be modified must be already registered.</p>
<p>After the real-name user has modified the email address or mobile phone number, he can log in using the modified email address or mobile phone number. The list of bound devices retrieved after login is the same as the original real-name user.</p>
<p>When you modify your Email address or mobile phone number, you can supplement your personal information at the same time. When you do not want to modify your personal information, the corresponding parameter can be set to nil. In the case of the Email address or user name is successfully modified and the personal information fails to be modified, the callback method will return success and prompt the failure reason of the personal information modification in errorMessage.</p>
<h4 id="2-7-1-Modify-Email-address"><a href="#2-7-1-Modify-Email-address" class="headerlink" title="2.7.1 Modify Email address"></a>2.7.1 Modify Email address</h4><p>When only Email address is needed to be modified, the parameter of the personal information is set to nil, and the user type can be set to GizUserEmail. The following is a code sample to modify a user’s Email address.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">GizWifiSDK.sharedInstance().changeUserInfo(&quot;your_token&quot;, &quot;your_email_address&quot;, null, GizUserAccountType.GizUserEmail, null);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public  void didChangeUserPassword(GizWifiErrorCode result) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-7-2-Modify-mobile-phone-number"><a href="#2-7-2-Modify-mobile-phone-number" class="headerlink" title="2.7.2 Modify mobile phone number"></a>2.7.2 Modify mobile phone number</h4><p>When only the user’s mobile phone number is needed to be modified, the personal information parameter is set to nil, and the user type can be set to GizUserPhone. Before modifying your mobile phone number, you need to get the SMS verification code. The following code sample is used to modify the user’s mobile phone number. For the code to get the SMS verification code, please refer to the registration with mobile phone number. </p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">GizWifiSDK.sharedInstance().changeUserInfo(&quot;your_token&quot;, &quot;your_phone_number&quot;, &quot;your_verify_code&quot;, GizUserAccountType.GizUserPhone, null);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public  void didChangeUserPassword(GizWifiErrorCode result) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-7-3-Modify-personal-information"><a href="#2-7-3-Modify-personal-information" class="headerlink" title="2.7.3 Modify personal information"></a>2.7.3 Modify personal information</h4><p>When only the user’s personal information is needed to be modified, the phone number or mailbox parameter is set to null, and the user type can be set to GizUserNormal. The personal information can contain multiple items, which can be specified by GizUserInfo class. The information that you do not want to modify is set to null, and the cloud will retain the last modified value.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line"></span><br><span class="line">GizUserInfo additionalInfo = new GizUserInfo();</span><br><span class="line">additionalInfo.setName(&quot;nickname&quot;);</span><br><span class="line">additionalInfo.setGender(GizUserGenderType.Male);</span><br><span class="line">additionalInfo.setBirthday(&quot;1990-1-1&quot;);</span><br><span class="line">additionalInfo.setAddress(&quot;Beijing&quot;);</span><br><span class="line">additionalInfo.setRemark(&quot;home&quot;);</span><br><span class="line"></span><br><span class="line">GizWifiSDK.sharedInstance().changeUserInfo(&quot;your_token&quot;, null, null, GizUserAccountType.GizUserNormal, additionalInfo);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public  void didChangeUserPassword(GizWifiErrorCode result) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-7-4-Modify-both-Email-addres-and-personal-information"><a href="#2-7-4-Modify-both-Email-addres-and-personal-information" class="headerlink" title="2.7.4 Modify both Email addres and personal information"></a>2.7.4 Modify both Email addres and personal information</h4><p>When modifying the Email address and personal information at the same time, the user type must be set to GizUserEmail.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line"></span><br><span class="line">GizUserInfo additionalInfo = new GizUserInfo();</span><br><span class="line">additionalInfo.setName(&quot;nickname&quot;);</span><br><span class="line">additionalInfo.setGender(GizUserGenderType.Male);</span><br><span class="line">additionalInfo.setBirthday(&quot;1990-1-1&quot;);</span><br><span class="line">additionalInfo.setAddress(&quot;Beijing&quot;);</span><br><span class="line">additionalInfo.setRemark(&quot;home&quot;);</span><br><span class="line"></span><br><span class="line">GizWifiSDK.sharedInstance().changeUserInfo(&quot;your_token&quot;, &quot;your_email_address&quot;, null, GizUserAccountType.GizUserEmail, additionalInfo);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public  void didChangeUserPassword(GizWifiErrorCode result) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-7-5-Modify-both-mobile-phone-number-and-personal-information"><a href="#2-7-5-Modify-both-mobile-phone-number-and-personal-information" class="headerlink" title="2.7.5 Modify both mobile phone number and personal information"></a>2.7.5 Modify both mobile phone number and personal information</h4><p>When modifying the mobile phone number and personal information at the same time, the user type must be set to GizUserPhone. To modify the mobile phone number, you also need to get the SMS verification code first. For the SMS verification code, please refer to the registration with mobile phone. </p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line"></span><br><span class="line">GizUserInfo additionalInfo = new GizUserInfo();</span><br><span class="line">additionalInfo.setName(&quot;nickname&quot;);</span><br><span class="line">additionalInfo.setGender(GizUserGenderType.Male);</span><br><span class="line">additionalInfo.setBirthday(&quot;1990-1-1&quot;);</span><br><span class="line">additionalInfo.setAddress(&quot;Beijing&quot;);</span><br><span class="line">additionalInfo.setRemark(&quot;home&quot;);</span><br><span class="line"></span><br><span class="line">GizWifiSDK.sharedInstance().changeUserInfo(&quot;your_token&quot;, &quot;your_phone_number&quot;, &quot;your_verify_code&quot;, GizUserAccountType.GizUserPhone, additionalInfo);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public  void didChangeUserPassword(GizWifiErrorCode result) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-Configure-device-to-access-network"><a href="#3-Configure-device-to-access-network" class="headerlink" title="3. Configure device to access network"></a>3. Configure device to access network</h2><p>Before controlling a device, you need to connect the device to a router. If the router can access internet, the device connected to the router will automatically register to Gizwits Cloud.</p>
<p>There are two ways to configure the device to connect to the router. One is Airlink and the other is SoftAP. The App can adopt the favorite approach according to product requirements. Before configuration, the device must first enter the configuration mode, and then the App calls the configuration API to send the router SSID and password to be configured. After the device is successfully configured, the SDK returns the configured MAC address and product type identifier of the device to the App, which is convenient for the App to perform the next step. If the device has entered the configuration mode after reset and does not have time to get the DID from the cloud when the configuration is successful, the DID value obtained by the App is empty.</p>
<p>If the timeout period of the configuration API of the SDK is not over, the next configuration cannot be performed. In addition, because the broadcast packet of the successful device configuration can be received only if the App is connected to the same router, the above timeout period should reserve the time for the App to connect to the router.</p>
<p>It should be noted that if the device configured is not the expected product type for the App, the device will not appear in the App device list.</p>
<h3 id="3-1-Flow-chart"><a href="#3-1-Flow-chart" class="headerlink" title="3.1 Flow chart"></a>3.1 Flow chart</h3><p><img src="../../../assets/en-us/AppDev/AndroidSDK/24.png" alt="Gizwits Device SDK"></p>
<h3 id="3-2-Configuration-with-AirLink"><a href="#3-2-Configuration-with-AirLink" class="headerlink" title="3.2 Configuration with AirLink"></a>3.2 Configuration with AirLink</h3><p>AirLink uses UDP broadcast sent from a mobile phone which contains the target router SSID and password. The Wi-Fi module on the device automatically connects to the target router after receiving the broadcast packet, and then sends a configuration success broadcast after connecting to the router to notify the mobile phone that the configuration has been completed.</p>
<p>After the Wi-Fi module enables AirLink mode, if it does not receive AirLink broadcast within one minute or is not able to connect to the router correctly, it will enter SoftAP mode.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// Let the phone connect to the target Wi-Fi</span><br><span class="line">// The MCU issues a serial port command to notify the module to enable AirLink mode. For details, please refer to &quot;Gizwits Air Conditioner –Serial Port Communication Protocol Document for Gizwits Cloud Access &quot;</span><br><span class="line"></span><br><span class="line">// Configure the device to access the network and send the Wi-Fi SSID and password to be configured.</span><br><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">List&lt;GizWifiGAgentType&gt; types = new ArrayList&lt;GizWifiGAgentType&gt; ();</span><br><span class="line">types.add(GizWifiGAgentType.GizGAgentESP); </span><br><span class="line">// This code example uses the latest network configuration API (Espressif or Hanfeng firmware require the version of 040002027 or higher, other module types do not require the minimum version)</span><br><span class="line">GizWifiSDK.sharedInstance().setDeviceOnboardingDeploy(&quot;your_ssid&quot;, &quot;your_key&quot;, GizWifiConfigureMode.GizWifiAirLink, null, 60, types, false);</span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">//Wait for configuration to complete or timeout, then call back the configuration completion interface</span><br><span class="line">@Override</span><br><span class="line">public  void didSetDeviceOnboarding (GizWifiErrorCode result, String mac, String did, String productKey) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">            // Configuration is successful</span><br><span class="line">		&#125; else if (result == GIZ_SDK_DEVICE_CONFIG_IS_RUNNING) &#123;</span><br><span class="line">		// Configuration in progress</span><br><span class="line">&#125; else &#123;</span><br><span class="line">            // Failed to configure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="3-3-Configuration-with-SoftAP"><a href="#3-3-Configuration-with-SoftAP" class="headerlink" title="3.3 Configuration with SoftAP"></a>3.3 Configuration with SoftAP</h3><p>After the device enters SoftAP mode, a Wi-Fi hotspot is created on it. After the mobile phone is connected to this hotspot, the SSID and password to be used are sent to the device. After receiving the SoftAP configuration package, the Wi-Fi module on the device automatically connects to the target router. Just like the AirLink, after the router is connected, the configuration success broadcast is sent to notify the mobile phone that the configuration is completed.</p>
<p>Using the Wi-Fi module firmware provided by Gizwits, the Wi-Fi hotspot created by the device starts with “XPG-GAgent-” and the password is “123456789”. Modules provided by other vendors, SoftAP hotspot names are specified by respective vendors. The App can give the correct hotspot prefix as needed.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// The MCU issues a serial port command to notify the module to enable SoftAP mode. For details, please refer to &quot;Gizwits Air Conditioner –Serial Port Communication Protocol Document for Gizwits Cloud Access &quot;</span><br><span class="line">//Let the phone connect to the module&apos;s SoftAP hotspot</span><br><span class="line"></span><br><span class="line">//Configure the device to access the network and send the Wi-Fi SSID and password to be configured.</span><br><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">// This code example uses the latest network configuration API (Espressif or Hanfeng firmware require the version of 040002027 or higher, other module types do not require the minimum version)</span><br><span class="line">GizWifiSDK.sharedInstance().setDeviceOnboardingDeploy(&quot;your_ssid&quot;, &quot;your_key&quot;, GizWifiConfigureMode.GizWifiSoftAP, &quot;your_gagent_hotspot_prefix&quot;, 60, null, false);</span><br><span class="line"></span><br><span class="line">//The module receives the configuration information, tries to connect to the router and automatically turns off the hotspot</span><br><span class="line">//Let the phone connect to the configured Wi-Fi network</span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">//Wait for configuration to complete or timeout, then call back the configuration completion interface</span><br><span class="line">@Override</span><br><span class="line">public  void didSetDeviceOnboarding (GizWifiErrorCode result, String mac, String did, String productKey) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">            // Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">            // Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="4-Device-discovery-and-subscription"><a href="#4-Device-discovery-and-subscription" class="headerlink" title="4. Device discovery and subscription"></a>4. Device discovery and subscription</h2><h3 id="4-1-Flow-chart"><a href="#4-1-Flow-chart" class="headerlink" title="4.1 Flow chart"></a>4.1 Flow chart</h3><p><img src="../../../assets/en-us/AppDev/AndroidSDK/25.png" alt="Gizwits Device SDK"></p>
<h3 id="4-2-Device-discovery"><a href="#4-2-Device-discovery" class="headerlink" title="4.2 Device discovery"></a>4.2 Device discovery</h3><p>After setting a delegate for the App and launching the SDK, the App can receive the push notification of device list from the SDK. Each time there are changes for the devices in the current LAN or bound devices, the SDK will automatically report the latest device list. When a device is powered off and then powered on, or a new device comes online, the device list will be refreshed. After the user logs in, the SDK will automatically report the list of devices that the user has bound to the App. The bound device can be obtained by the same user account on different mobile phones.</p>
<p>If the App wants to refresh the list of bound devices, you can call the bound device list API and specify the product type identifier that you care about. The SDK will return the filtered device list to the App.</p>
<p>The SDK provides a device list cache, and device objects in the device list remain valid throughout the App lifecycle. The cached device list is updated synchronously with the most recently discovered devices.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// Refresh the UI with a cached device list</span><br><span class="line">List&lt;GizWifiDevice&gt; devices = GizWifiSDK.sharedInstance().getDeviceList();</span><br><span class="line"></span><br><span class="line">// Receive the reported device list change, refresh UI</span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public  void didDiscovered(GizWifiErrorCode result, List&lt;GizWifiDevice&gt; deviceList) &#123;</span><br><span class="line">        // Prompt error reason</span><br><span class="line">        if(result != GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">            Log.d(&quot;&quot;, &quot;result: &quot; + result.name());</span><br><span class="line">        &#125;</span><br><span class="line">        // Display the changed list of devices</span><br><span class="line">        Log.d(&quot;&quot;, &quot;discovered deviceList: &quot; + deviceList);</span><br><span class="line">devices = deviceList;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// Actively refresh the list of bound devices, specify productKey to filter devices </span><br><span class="line">List&lt;String&gt; pks = new ArrayList&lt;String&gt; ();</span><br><span class="line">pks.add(&quot;your_productKey&quot;);</span><br><span class="line">GizWifiSDK.sharedInstance().getBoundDevices(&quot;your_uid&quot;, &quot;your_token&quot;, pks);</span><br></pre></td></tr></table></figure>
<h3 id="4-3-Set-device-delegate"><a href="#4-3-Set-device-delegate" class="headerlink" title="4.3 Set device delegate"></a>4.3 Set device delegate</h3><p>Get the device objects in the device list, set the device delegate for each of them, in order to refresh the device related UI. The App implements the corresponding callback according to its own needs.</p>
<h3 id="4-4-Device-subscription-and-binding"><a href="#4-4-Device-subscription-and-binding" class="headerlink" title="4.4 Device subscription and binding"></a>4.4 Device subscription and binding</h3><p>After the App gets the device list and sets delegate, you can subscribe to the device. The subscribed device will be automatically bound and automatically log in. After the device logs in successfully, it will automatically report the latest status.</p>
<p>The automatically bound devices are limited to the same LAN where your App resides. For devices that cannot be discovered in the LAN, the App can bind them manually. A device that is successfully bound must be subscribed before it can be used.</p>
<p>Whether it is manual binding or automatic binding, the remark and alias information of the device must be set after the device is successfully bound.</p>
<p>If the device is unsubscribed, the connection will be disconnected and instructions are not able to be issued to the device.</p>
<h4 id="4-4-1-Device-subscription"><a href="#4-4-1-Device-subscription" class="headerlink" title="4.4.1 Device subscription"></a>4.4.1 Device subscription</h4><p>All devices obtained through the SDK can be subscribed, and the subscription result is returned via callback. Status query and instructions issuing can only be perform on those successfully subscribed devices when their network becomes available.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// Take the first device instance in the device list as an example, set the listener for it.</span><br><span class="line">GizWifiDevice mDevice = null;</span><br><span class="line">for (int i = 0; i &lt; deviceList.size(); i++) &#123;</span><br><span class="line">	mDevice = deviceList[0];</span><br><span class="line">mDevice.setListener(mListener);</span><br><span class="line">mDevice.setSubscribe(true);</span><br><span class="line">break;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">GizWifiDeviceListener mListener = new GizWifiDeviceListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public  void didSetSubscribe(GizWifiErrorCode result, GizWifiDevice device, boolean isSubscribed) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="4-4-2-Non-LAN-device-binding"><a href="#4-4-2-Non-LAN-device-binding" class="headerlink" title="4.4.2 Non-LAN device binding"></a>4.4.2 Non-LAN device binding</h4><p>The App can complete the binding of the non-LAN device through the MAC, productKey, and productSecret of the device. The above information can be used to generate a QR code, which will be used by the App to bind the device. GPRS devices, Bluetooth devices, etc. are devices that cannot be discovered through the Wi-Fi LAN, and all belong to non-LAN devices.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">GizWifiSDK.sharedInstance().bindRemoteDevice (&quot;your_uid&quot;, &quot;your_token&quot;, &quot;your_device_mac&quot;, &quot;your_device_product_key&quot;, &quot;your_product_secret&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void didBindDevice(GizWifiErrorCode result, String did) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">            // Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">            // Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="4-4-3-Set-device-binding-information"><a href="#4-4-3-Set-device-binding-information" class="headerlink" title="4.4.3 Set device binding information"></a>4.4.3 Set device binding information</h4><p>You can also set the binding information of the device without subscribing to it. Find the device you want to modify the remark and alias information in the device list if it is bound already.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// mDevice is the device entity object obtained from the device list, setting the listener for it.</span><br><span class="line">mDevice.setCustomInfo(&quot;your_remark&quot;, &quot;your_alias&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GizWifiDeviceListener mListener = new GizWifiDeviceListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void didSetCustomInfo(GizWifiErrorCode result, GizWifiDevice device) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">// Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="4-5-Unbind-device"><a href="#4-5-Unbind-device" class="headerlink" title="4.5 Unbind device"></a>4.5 Unbind device</h3><p>The bound device can be unbound. To unbind a device requires the App to invoke the API to complete the operation. The SDK does not support automatic unbinding. For the device subscribed to, after unbound, it will be un-subscribed and disconnected and not report status. Thus, the App will not get the device when it refreshes the device list.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">GizWifiSDK.sharedInstance().setListener(mListener);</span><br><span class="line">GizWifiSDK.sharedInstance().unbindDevice(&quot;your_uid&quot;, &quot;your_token&quot;, &quot;your_device_did&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GizWifiSDKListener mListener = new GizWifiSDKListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void didUnbindDevice(GizWifiErrorCode result, String did) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">            // Success</span><br><span class="line">&#125; else &#123;</span><br><span class="line">            // Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="4-6-Get-hardware-information"><a href="#4-6-Get-hardware-information" class="headerlink" title="4.6 Get hardware information"></a>4.6 Get hardware information</h3><p>Hardware information can be obtained without subscribing to the device. The App can get hardware information such as the module protocol version number and the MCU firmware version number, but only by the way of Micro Cycle.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">// mDevice is the device entity object obtained from the device list, setting the listener for it.</span><br><span class="line">mDevice.setListener(mListener);</span><br><span class="line">mDevice.getHardwareInfo();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GizWifiDeviceListener mListener = new GizWifiDeviceListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public  void didGetHardwareInfo(GizWifiErrorCode result, GizWifiDevice device, ConcurrentHashMap&lt;String, String&gt; hardwareInfo) &#123;</span><br><span class="line">StringBuilder sb = new StringBuilder();</span><br><span class="line">if(result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">sb.append(&quot;Wifi Hardware Version:&quot; + hardwareInfo.get(&quot;wifiHardVersion&quot;)</span><br><span class="line">						+ &quot;\r\n&quot;);</span><br><span class="line">sb.append(&quot;Wifi Software Version:&quot; + hardwareInfo.get(&quot;wifiSoftVersion&quot;)</span><br><span class="line">						+ &quot;\r\n&quot;);</span><br><span class="line">sb.append(&quot;MCU Hardware Version:&quot; + hardwareInfo.get(&quot;mcuHardVersion&quot;)</span><br><span class="line">						+ &quot;\r\n&quot;);</span><br><span class="line">sb.append(&quot;MCU Software Version:&quot; + hardwareInfo.get(&quot;mcuSoftVersion&quot;)</span><br><span class="line">						+ &quot;\r\n&quot;);</span><br><span class="line">sb.append(&quot;Firmware Id:&quot; + hardwareInfo.get(&quot;wifiFirmwareId&quot;) + &quot;\r\n&quot;);</span><br><span class="line">sb.append(&quot;Firmware Version:&quot; + hardwareInfo.get(&quot;wifiFirmwareVer&quot;)</span><br><span class="line">						+ &quot;\r\n&quot;);</span><br><span class="line">sb.append(&quot;Product Key:&quot; + hardwareInfo.get(&quot;productKey&quot;) + &quot;\r\n&quot;);</span><br><span class="line">sb.append(&quot;Device ID:&quot; + device.getDid() + &quot;\r\n&quot;);</span><br><span class="line">sb.append(&quot;Device IP:&quot; + device.getIPAddress() + &quot;\r\n&quot;);</span><br><span class="line">sb.append(&quot;Device MAC:&quot; + device.getMacAddress() + &quot;\r\n&quot;);</span><br><span class="line"></span><br><span class="line">&#125;else&#123;</span><br><span class="line">sb.append(&quot;获取失败，错误号：&quot; + result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Message msg = new Message();</span><br><span class="line">msg.what = HARDWARE;</span><br><span class="line">msg.obj = sb.toString();</span><br><span class="line">handler.sendMessage(msg);</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="5-Device-control"><a href="#5-Device-control" class="headerlink" title="5. Device control"></a>5. Device control</h2><p>The SDK controls devices and receives device status through dictionary key-value pairs. After receiving dictionary key-value pairs of an instruction sent by the App, the SDK parses the data that can be recognized by the device and sends it to the device. In the opposite direction, after receiving the data that the device replies or reports, the SDK parses it to dictionary key-value pairs and reports it to the App.</p>
<p>The GAgent firmware and Gizwits serial port communication protocol need to be flashed onto the smart device correctly. If data points are defined for the device, the instructions sent by the App must conform to the data point definition. If there is no data point defined for the device, the device instructions can be issued in a custom format.</p>
<h3 id="5-1-Flow-chart"><a href="#5-1-Flow-chart" class="headerlink" title="5.1 Flow chart"></a>5.1 Flow chart</h3><p><img src="../../../assets/en-us/AppDev/AndroidSDK/26.png" alt="Gizwits Device SDK"></p>
<h3 id="5-2-Send-device-instructions"><a href="#5-2-Send-device-instructions" class="headerlink" title="5.2 Send device instructions"></a>5.2 Send device instructions</h3><p>After the device subscription becomes available, the App can send instructions. Device instructions are in dictionary format, with key-value pairs being data point names and values. The instruction result is returned in the didReceiveData callback.</p>
<p>When the App issues an instruction in which the parameter sn can be specified, and the parameter sn in the callback can indicate whether the issued instruction is successfully sent. However, the callback parameter dataMap may be an empty dictionary, depending on whether the device passes the current data point status when replying.</p>
<p>If the App only concerns whether there is a device status report after the instruction is issued, the parameter sn of the issued instruction can be filled with 0, and the callback parameter sn is also 0.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">// mDevice is the device entity object obtained from the device list, setting the listener for it.</span><br><span class="line">mDevice.setListener(mListener);</span><br><span class="line"></span><br><span class="line">// After the device is subscribed and becomes controllable, the light-on action is performed.</span><br><span class="line">int sn = 5;</span><br><span class="line">ConcurrentHashMap&lt;String, Object&gt; command = new ConcurrentHashMap&lt;String, Object&gt; ();</span><br><span class="line">command.put(&quot;LED_OnOff&quot;, true);</span><br><span class="line">mDevice.write(command, sn);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GizWifiDeviceListener mListener = new GizWifiDeviceListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public  void didReceiveData(GizWifiErrorCode result, GizWifiDevice device, ConcurrentHashMap&lt;String, Object&gt; dataMap, int sn) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">if (sn == 5) &#123;</span><br><span class="line">		// The command sequence number matches, and the light-on command is executed successfully.</span><br><span class="line">&#125; else &#123;</span><br><span class="line">		// ACK for other command or data report</span><br><span class="line">&#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">// Failure</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="5-3-Get-device-status"><a href="#5-3-Get-device-status" class="headerlink" title="5.3 Get device status"></a>5.3 Get device status</h3><p>After the device subscription becomes available, the App can receive the device status report at any time through the didReceiveData callback. When the device reports its status, the callback parameter sn is 0, and the callback parameter dataMap has the status reported by the device.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">GizWifiDeviceListener mListener = new GizWifiDeviceListener() &#123;</span><br><span class="line">@Override</span><br><span class="line">public void didReceiveData(GizWifiErrorCode result, GizWifiDevice device, ConcurrentHashMap&lt;String, Object&gt; dataMap, int sn) &#123;</span><br><span class="line">if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line"></span><br><span class="line">    // Defined device data points with boolean, numeric, and enumeration data</span><br><span class="line">    if (dataMap.get(&quot;data&quot;) != null) &#123;</span><br><span class="line">	ConcurrentHashMap&lt;String, Object&gt; map = (ConcurrentHashMap&lt;String, Object&gt;) dataMap.get(&quot;data&quot;);</span><br><span class="line"></span><br><span class="line">		// Regular data points, print the corresponding key and value pairs</span><br><span class="line">		StringBuilder sb = new StringBuilder();</span><br><span class="line">		for (String key : map.keySet()) &#123;</span><br><span class="line">			sb.append(key + &quot;  :&quot; + map.get(key) + &quot;\r\n&quot;);</span><br><span class="line">			Toast.makeText(DeviceControlActivity.this,</span><br><span class="line">					sb.toString(), Toast.LENGTH_SHORT).show();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		// Extended data point, if the key is &quot;BBBB&quot;</span><br><span class="line">		byte[] bytes = (byte[]) map.get(&quot;BBBB&quot;);</span><br><span class="line">		String string = Arrays.toString(bytes);</span><br><span class="line">		Toast.makeText(DeviceControlActivity.this,</span><br><span class="line">				string, Toast.LENGTH_SHORT).show();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">        // The device defined fault data points. After the device failures occurred, the field is populated. If there is no fault, it is empty.</span><br><span class="line">	if (dataMap.get(&quot;faults&quot;) != null) &#123;</span><br><span class="line">	ConcurrentHashMap&lt;String, Object&gt; map =  (ConcurrentHashMap&lt;String, Object&gt;)dataMap.get(&quot;faults&quot;);</span><br><span class="line">		StringBuilder sb = new StringBuilder();</span><br><span class="line"></span><br><span class="line">		for (String key : map.keySet()) &#123;</span><br><span class="line">			sb.append(key + &quot;  :&quot; +  map.get(key) + &quot;\r\n&quot;);</span><br><span class="line">			Toast.makeText(DeviceControlActivity.this,</span><br><span class="line">					sb.toString(), Toast.LENGTH_SHORT).show();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">        // The device defined alarm data points. After the device has alarms, the field is populated. If there is no alarm, it is empty.</span><br><span class="line">	if (dataMap.get(&quot;alerts&quot;) != null) &#123;</span><br><span class="line">	ConcurrentHashMap&lt;String, Object&gt; map =  (ConcurrentHashMap&lt;String, Object&gt;)dataMap.get(&quot;alerts&quot;);</span><br><span class="line">		StringBuilder sb = new StringBuilder();</span><br><span class="line"></span><br><span class="line">		for (String key : map.keySet()) &#123;</span><br><span class="line">					sb.append(key + &quot;  :&quot; +  map.get(key) + &quot;\r\n&quot;);</span><br><span class="line">					Toast.makeText(DeviceControlActivity.this,</span><br><span class="line">					sb.toString(), Toast.LENGTH_SHORT).show();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">        // Transparent transmission, no defined data points, suitable for developers to define their own protocols</span><br><span class="line">	if (dataMap.get(&quot;binary&quot;) != null) &#123;</span><br><span class="line">		byte[] binary = (byte[]) dataMap.get(&quot;binary&quot;);</span><br><span class="line">		Log.i(&quot;&quot;, &quot;Binary data:&quot;</span><br><span class="line">				+ bytesToHex(binary, 0, binary.length));</span><br><span class="line">	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="5-4-Device-status-query"><a href="#5-4-Device-status-query" class="headerlink" title="5.4 Device status query"></a>5.4 Device status query</h3><p>After the device subscription becomes available, the App can query the device status. The device status query result is also obtained by the didReceiveData callback, and the callback parameter sn is 0. The callback parameter dataMap has the status of the returned status.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// mDevice is the device entity object obtained from the device list, setting the listener for it</span><br><span class="line">mDevice.setListener(mListener);</span><br><span class="line">mDevice.getDeviceStatus();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GizWifiDeviceListener mListener = new GizWifiDeviceListener() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public  void didReceiveData(GizWifiErrorCode result, GizWifiDevice device, ConcurrentHashMap&lt;String, Object&gt; dataMap, int sn) &#123;</span><br><span class="line">        if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">            // The data parse is the same as section 3.5.3</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            // Failure</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="6-Device-task-scheduling"><a href="#6-Device-task-scheduling" class="headerlink" title="6. Device task scheduling"></a>6. Device task scheduling</h2><p>By setting up a scheduled task for a device, you can have the device perform certain actions on a predetermined date and time. These tasks can be repeated on certain days of each month or on certain days of each week.</p>
<p>Scheduled tasks can be set first and then executed or stopped at any time. The scheduled task is enabled by default when it is created.</p>
<h3 id="6-1-Flow-chart"><a href="#6-1-Flow-chart" class="headerlink" title="6.1 Flow chart"></a>6.1 Flow chart</h3><p><img src="../../../assets/en-us/AppDev/AndroidSDK/27.png" alt="Gizwits Device SDK"></p>
<h3 id="6-2-Create-a-scheduled-task"><a href="#6-2-Create-a-scheduled-task" class="headerlink" title="6.2 Create a scheduled task"></a>6.2 Create a scheduled task</h3><p>Scheduled tasks can be executed repeatedly or only once, and repeated tasks are divided into monthly occurring tasks and weekly occurring tasks. However, you can only specify one type of repetition at the same time, that is, not repeated or repeated on a weekly basis or repeated on a monthly basis.</p>
<p>When using the SDK API, the parameter weekDays is set for weekly occurring tasks and the parameter monthDays is set for monthly occurring tasks. However, if both are set, only the parameter weekDays will be used.</p>
<p>The following three examples are shown below.</p>
<h4 id="6-2-1-Create-a-one-time-scheduled-task"><a href="#6-2-1-Create-a-one-time-scheduled-task" class="headerlink" title="6.2.1 Create a one-time scheduled task"></a>6.2.1 Create a one-time scheduled task</h4><p>Suppose we need to turn on a light at 6:30 am on January 16, 2017. In the following code, the date and time are set to the corresponding values, where the date is 2017-01-16, the time is 06:30 (in 24-hour format).</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// Set up scheduled task listener</span><br><span class="line">GizDeviceSchedulerCenter.setListener(mListener);</span><br><span class="line"></span><br><span class="line">// Create a one-time scheduled task，to turn on a light at 6:30 am on January 16, 2017. </span><br><span class="line">GizDeviceScheduler scheduler = new GizDeviceScheduler();</span><br><span class="line">scheduler.setDate(&quot;2017-01-16&quot;);</span><br><span class="line">scheduler.setTime(&quot;06:30&quot;);</span><br><span class="line">scheduler.setRemark(&quot;开灯任务&quot;);</span><br><span class="line">ConcurrentHashMap&lt;String, Object&gt; attrs = new ConcurrentHashMap&lt;String, Object&gt;();</span><br><span class="line">attrs.put(&quot;LED_OnOff&quot;, true);</span><br><span class="line">scheduler.setAttrs(attrs);</span><br><span class="line"></span><br><span class="line">// Create a scheduled task for the device mDevice that is the device object obtained in the device list.</span><br><span class="line">GizDeviceSchedulerCenter.createScheduler(&quot;your_uid&quot;, &quot;your_token&quot;, mDevice, scheduler);</span><br><span class="line"></span><br><span class="line">GizDeviceSchedulerCenterListener mListener = new GizDeviceSchedulerCenterListener() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void didUpdateSchedulers(GizWifiErrorCode result, GizWifiDevice schedulerOwner, List&lt;GizDeviceScheduler&gt; schedulerList) &#123;</span><br><span class="line">        if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">            // Success</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            // Failure</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="6-2-2-Create-a-weekly-occurring-scheduled-task"><a href="#6-2-2-Create-a-weekly-occurring-scheduled-task" class="headerlink" title="6.2.2 Create a weekly occurring scheduled task"></a>6.2.2 Create a weekly occurring scheduled task</h4><p>We now get the scheduled task executed on a weekly basis, and we have to turn on a light every Monday to Friday at 6:30 in the morning.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">// Set up scheduled task listener</span><br><span class="line">GizDeviceSchedulerCenter.setListener(mListener);</span><br><span class="line"></span><br><span class="line">// Create a weekly occurring scheduled task to turn on a light every Monday to Friday </span><br><span class="line">GizDeviceScheduler scheduler = new GizDeviceScheduler();</span><br><span class="line">scheduler.setDate(&quot;2017-01-16&quot;);</span><br><span class="line">scheduler.setTime(&quot;06:30&quot;);</span><br><span class="line">scheduler.setRemark(&quot;开灯任务&quot;);</span><br><span class="line">ConcurrentHashMap&lt;String, Object&gt; attrs = new ConcurrentHashMap&lt;String, Object&gt;();</span><br><span class="line">attrs.put(&quot;LED_OnOff&quot;, true);</span><br><span class="line">scheduler.setAttrs(attrs);</span><br><span class="line">List&lt;GizScheduleWeekday&gt; weekDays = new ArrayList&lt;GizScheduleWeekday&gt;();</span><br><span class="line">weekDays.add(GizScheduleWeekday.GizScheduleMonday);</span><br><span class="line">weekDays.add(GizScheduleWeekday.GizScheduleTuesday);</span><br><span class="line">weekDays.add(GizScheduleWeekday.GizScheduleWednesday);</span><br><span class="line">weekDays.add(GizScheduleWeekday.GizScheduleThursday);</span><br><span class="line">weekDays.add(GizScheduleWeekday.GizScheduleFriday);</span><br><span class="line">scheduler.setMonthDays(monthDays);</span><br><span class="line"></span><br><span class="line">// Create a scheduled task for the device mDevice that is the device object obtained in the device list.</span><br><span class="line">GizDeviceSchedulerCenter.createScheduler(&quot;your_uid&quot;, &quot;your_token&quot;, mDevice, scheduler);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GizDeviceSchedulerCenterListener mListener = new GizDeviceSchedulerCenterListener() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void didUpdateSchedulers(GizWifiErrorCode result, GizWifiDevice schedulerOwner, List&lt;GizDeviceScheduler&gt; schedulerList) &#123;</span><br><span class="line">        if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">            // Success</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            // Failure</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="6-2-3-Create-a-monthly-occurring-scheduled-task"><a href="#6-2-3-Create-a-monthly-occurring-scheduled-task" class="headerlink" title="6.2.3 Create a monthly occurring scheduled task"></a>6.2.3 Create a monthly occurring scheduled task</h4><p>We now get the scheduled tasks executed on a monthly basis, and we have to turn on the light on the 1st and 15th of each month at 6:30 in the morning. </p>
<p>Note that do not set a weekly occurring scheduled task together with a monthly occurring scheduled task. If you do so, the monthly occurring scheduled task will be ignored. </p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">// Set up scheduled task listener</span><br><span class="line">GizDeviceSchedulerCenter.setListener(mListener);</span><br><span class="line"></span><br><span class="line">// Create a monthly occurring scheduled task to turn on the light on the 1st and 15th of each month</span><br><span class="line">GizDeviceScheduler scheduler = new GizDeviceScheduler();</span><br><span class="line">scheduler.setDate(&quot;2017-01-16&quot;);</span><br><span class="line">scheduler.setTime(&quot;06:30&quot;);</span><br><span class="line">scheduler.setRemark(&quot;开灯任务&quot;);</span><br><span class="line">ConcurrentHashMap&lt;String, Object&gt; attrs = new ConcurrentHashMap&lt;String, Object&gt;();</span><br><span class="line">attrs.put(&quot;LED_OnOff&quot;, true);</span><br><span class="line">scheduler.setAttrs(attrs);</span><br><span class="line">List&lt;Integer&gt; monthDays = new ArrayList&lt;Integer&gt;();</span><br><span class="line">monthDays.add(1);</span><br><span class="line">monthDays.add(15);</span><br><span class="line">scheduler.setMonthDays(monthDays);</span><br><span class="line"></span><br><span class="line">// Create a scheduled task for the device mDevice that is the device object obtained in the device list.</span><br><span class="line">GizDeviceSchedulerCenter.createScheduler(&quot;your_uid&quot;, &quot;your_token&quot;, mDevice, scheduler);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GizDeviceSchedulerCenterListener mListener = new GizDeviceSchedulerCenterListener() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void didUpdateSchedulers(GizWifiErrorCode result, GizWifiDevice schedulerOwner, List&lt;GizDeviceScheduler&gt; schedulerList) &#123;</span><br><span class="line">        if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">            // Success</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            // Failure</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="6-3-Obtain-the-scheduled-task-list"><a href="#6-3-Obtain-the-scheduled-task-list" class="headerlink" title="6.3 Obtain the scheduled task list"></a>6.3 Obtain the scheduled task list</h3><p>After creating a scheduled task, you can get a list of all scheduled tasks that have been created. After obtaining the scheduled task list, you can modify or delete any created scheduled task in the list.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// Set up scheduled task listener</span><br><span class="line">GizDeviceSchedulerCenter.setListener(mListener);</span><br><span class="line"></span><br><span class="line">// Synchronize the scheduled task list of the device mDevice that is the device object obtained in the device list.</span><br><span class="line">GizDeviceSchedulerCenter.updateSchedulers(&quot;your_uid&quot;, &quot;your_token&quot;, mDevice);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GizDeviceSchedulerCenterListener mListener = new GizDeviceSchedulerCenterListener() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void didUpdateSchedulers(GizWifiErrorCode result, GizWifiDevice schedulerOwner, List&lt;GizDeviceScheduler&gt; schedulerList) &#123;</span><br><span class="line">        if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">            // Success</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            // Failure</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="6-4-Modify-a-scheduled-task"><a href="#6-4-Modify-a-scheduled-task" class="headerlink" title="6.4 Modify a scheduled task"></a>6.4 Modify a scheduled task</h3><p>You can modify a scheduled task that has been created. When modifying, the scheduled task object is taken out from the obtained scheduled task list.</p>
<p>Note that once a scheduled task is created, it is assigned an ID that cannot be modified.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// Set up scheduled task listener</span><br><span class="line">GizDeviceSchedulerCenter.setListener(mListener);</span><br><span class="line"></span><br><span class="line">// Modify the previously created one-time scheduled task to a scheduled task that is executed repeatedly on the 1st and 15th of each month. The scheduler is the scheduled task object to be modified in the scheduled task list.</span><br><span class="line">scheduler.setTime(&quot;06:30&quot;);</span><br><span class="line">scheduler.setRemark(&quot;开灯任务&quot;);</span><br><span class="line">ConcurrentHashMap&lt;String, Object&gt; attrs = new ConcurrentHashMap&lt;String, Object&gt;();</span><br><span class="line">attrs.put(&quot;LED_OnOff&quot;, true);</span><br><span class="line">scheduler.setAttrs(attrs);</span><br><span class="line">List&lt;Integer&gt; monthDays = new ArrayList&lt;Integer&gt;();</span><br><span class="line">monthDays.add(1);</span><br><span class="line">monthDays.add(15);</span><br><span class="line">scheduler.setMonthDays(monthDays);</span><br><span class="line"></span><br><span class="line">// Modify the scheduled task of the device mDevice that is the device object in the device list to create a scheduled task.</span><br><span class="line">GizDeviceSchedulerCenter.editScheduler(&quot;your_uid&quot;, &quot;your_token&quot;, mDevice, scheduler);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GizDeviceSchedulerCenterListener mListener = new GizDeviceSchedulerCenterListener() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void didUpdateSchedulers(GizWifiErrorCode result, GizWifiDevice schedulerOwner, List&lt;GizDeviceScheduler&gt; schedulerList) &#123;</span><br><span class="line">        if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">            // Success</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            // Failure</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="6-5-Delete-a-scheduled-task"><a href="#6-5-Delete-a-scheduled-task" class="headerlink" title="6.5 Delete a scheduled task"></a>6.5 Delete a scheduled task</h3><p>In the obtained scheduled task list, find the scheduled task ID to be deleted and delete it.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// Set up scheduled task listener</span><br><span class="line">GizDeviceSchedulerCenter.setListener(mListener);</span><br><span class="line"></span><br><span class="line">// Delete the scheduled task list of the device mDevice that is the device object obtained in the device list. your_scheduler_id is the ID of the scheduled task to be deleted.</span><br><span class="line">GizDeviceSchedulerCenter.deleteScheduler(&quot;your_uid&quot;, &quot;your_token&quot;, mDevice, &quot;your_scheduler_id&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GizDeviceSchedulerCenterListener mListener = new GizDeviceSchedulerCenterListener() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void didUpdateSchedulers(GizWifiErrorCode result, GizWifiDevice schedulerOwner, List&lt;GizDeviceScheduler&gt; schedulerList) &#123;</span><br><span class="line">        if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">            // Success</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            // Failure</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="7-Device-sharing"><a href="#7-Device-sharing" class="headerlink" title="7. Device sharing"></a>7. Device sharing</h2><p>After binding a device, you can let others use the device through device sharing. In order to facilitate multiple customers use the same device, device sharing provides device permission management with a more secure and convenient device binding. There are four types of device permissions for device binding:</p>
<ul>
<li>Owner: The primary account of the device, who can share the device;</li>
<li>Guest: The guest account of the device, who can accept the sharing invitation and can no longer share the device to other users;</li>
<li>Special: The account who has bound to the device at the earliest but has not shared the device, and will become the Owner of the device after sharing it;</li>
<li>Normal: The account that has bound to the device but cannot share the device or become the Owner of the device.</li>
</ul>
<p>Only the user bound to a device at the earliest or the Owner of a device can share the device. Once a device has an Owner account, other users can no longer bind the device. The Owner can view the currently users bound to the device and can unbind other users. When a device does not have an Owner, other users can bind the device.</p>
<h3 id="7-1-Flow-chart"><a href="#7-1-Flow-chart" class="headerlink" title="7.1 Flow chart"></a>7.1 Flow chart</h3><p><img src="../../../assets/en-us/AppDev/AndroidSDK/28.png" alt="Gizwits Device SDK"></p>
<h3 id="7-2-Make-a-device-sharing-invitation"><a href="#7-2-Make-a-device-sharing-invitation" class="headerlink" title="7.2 Make a device sharing invitation"></a>7.2 Make a device sharing invitation</h3><p>Before sharing your devices, check which devices you can share. Using the SDK, the App can traverse the list of devices and find those devices on which the currently logged in user has a permission of GizDeviceSharingSpecial or GizDeviceSharingOwner to create a device sharing invitation.</p>
<p>There are two ways to create a device sharing invitation by Owner and Special: Device Sharing via user ID and Device Sharing via QR code.</p>
<h4 id="7-2-1-Device-Sharing-via-user-ID"><a href="#7-2-1-Device-Sharing-via-user-ID" class="headerlink" title="7.2.1 Device Sharing via user ID"></a>7.2.1 Device Sharing via user ID</h4><p>For Device Sharing via user ID, the receiver’s ID can be a mobile phone number, an email address, a regular user name, or an anonymous ID, but it must be a user who has already registered in Gizwits Cloud. If the user is already the Guest of this device or has already bound the device, the sharing invitation will fail to be created. The sharing invitation is valid for 24 hours, that is, the receiver must respond within 24 hours, otherwise the invitation will expire. </p>
<p>You need to specify the user ID type. The guestUser parameter for the anonymous user should be set to the uid of the anonymous user. When the Account Sharing is created successfully, the sharingID will be returned in the callback parameter, but the QRCodeImage will not be returned. The following is only an example of device sharing to a user registered with mobile phone number:</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// Set device sharing listener</span><br><span class="line">GizDeviceSharing.setListener(mListener);</span><br><span class="line"></span><br><span class="line">// Find devices that can be shared in the device list</span><br><span class="line"></span><br><span class="line">// Share the device via phone number</span><br><span class="line">GizDeviceSharing.sharingDevice(&quot;your_token&quot;, &quot;your_device_id&quot;, GizDeviceSharingWay.GizDeviceSharingByNormal, &quot;guest_phone_number&quot;, GizUserAccountType.GizUserPhone);</span><br><span class="line"></span><br><span class="line">GizDeviceSharingListener mListener = new GizDeviceSharingListener() &#123;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void didSharingDevice(GizWifiErrorCode result, String deviceID, int sharingID, Bitmap QRCodeImage) &#123;</span><br><span class="line">        if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">            // Success</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            // Failure</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="7-2-2-Device-Sharing-via-QR-code"><a href="#7-2-2-Device-Sharing-via-QR-code" class="headerlink" title="7.2.2 Device Sharing via QR code"></a>7.2.2 Device Sharing via QR code</h4><p>For the Device Sharing via QR code, the QR code is valid for 15 minutes, that is, the receiver must scan the generated QR code within 15 minutes and respond, otherwise the QR code invitation will expire. When the QR code Sharing invitation is created successfully, the sharingID will be returned in the callback parameter, and the corresponding QRCodeImage will also be returned. The App can directly load the QR code image.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// Set device sharing listener</span><br><span class="line">GizDeviceSharing.setListener(mListener);</span><br><span class="line"></span><br><span class="line">// Find devices that can be shared in the device list</span><br><span class="line"></span><br><span class="line">// Share the device via QR code</span><br><span class="line">GizDeviceSharing.sharingDevice(&quot;your_token&quot;, &quot;your_device_id&quot;, GizDeviceSharingWay.GizDeviceSharingByQRCode, null, null);</span><br><span class="line"></span><br><span class="line">GizDeviceSharingListener mListener = new GizDeviceSharingListener() &#123;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void didSharingDevice(GizWifiErrorCode result, String deviceID, int sharingID, Bitmap QRCodeImage) &#123;</span><br><span class="line">        if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">            // Success</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            // Failure</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="7-3-Accept-sharing-invitation"><a href="#7-3-Accept-sharing-invitation" class="headerlink" title="7.3 Accept sharing invitation"></a>7.3 Accept sharing invitation</h3><p>The Guest account can query the received sharing invitations. Only the Guest account can accept the sharing invitation.</p>
<p>If a sharing invitation received by the Guest has not yet been accepted, the Guest can accept or reject it.</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">// Set device sharing listener</span><br><span class="line">GizDeviceSharing.setListener(mListener);</span><br><span class="line"></span><br><span class="line">// Query the list of sharing invitations sent to you</span><br><span class="line">GizDeviceSharing.getDeviceSharingInfos(&quot;your_token&quot;, GizDeviceSharingType.GizDeviceSharingToMe, &quot;your_device_id&quot;);</span><br><span class="line"></span><br><span class="line">GizDeviceSharingListener mListener = new GizDeviceSharingListener() &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void didGetDeviceSharingInfos(GizWifiErrorCode result, String deviceID, List&lt;GizDeviceSharingInfo&gt; deviceSharingInfos) &#123;</span><br><span class="line">        if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line"></span><br><span class="line">	    	// Successfully retrieved. Find the share invitations that have not yet been accepted in deviceSharingInfos. your_sharing_id is the ID of the share invitation to be acceptted</span><br><span class="line">	    	int your_sharing_id = -1;</span><br><span class="line">	    	for (int i = 0; i &lt; deviceSharingInfos.size(); i++) &#123;</span><br><span class="line">	    		GizDeviceSharingInfo mDeviceSharing = deviceSharingInfos.get(i);</span><br><span class="line">	    		if (mDeviceSharing.getStatus() == GizDeviceSharingStatus.GizDeviceSharingNotAccepted) &#123;</span><br><span class="line">	    			your_sharing_id = mDeviceSharing.getId();</span><br><span class="line">	    			break;</span><br><span class="line">	    		&#125;</span><br><span class="line">	    	&#125;</span><br><span class="line">    </span><br><span class="line">	    	// Accept invitation</span><br><span class="line">	    	if (your_sharing_id != -1) &#123;</span><br><span class="line">	    		GizDeviceSharing.acceptDeviceSharing(&quot;your_token&quot;, your_sharing_id, true);</span><br><span class="line">	    	&#125;</span><br><span class="line"></span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            // Failed to retrieve</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void didAcceptDeviceSharing(GizWifiErrorCode result, int sharingID) &#123;</span><br><span class="line">        if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">            // Success</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            // Failure</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h1 id="See-Also"><a href="#See-Also" class="headerlink" title="See Also"></a>See Also</h1><p>See “Introduction to App code auto-generator” to understand what functions the automatically generated App code has;</p>
<p>See “App open source framework” to understand</p>
<ul>
<li>Guide of App open source framework for iOS</li>
<li>Guide of iOS App push notification integration</li>
<li>Guide of iOS App third-party authentication and re-skin</li>
<li>Quick start of iOS App development</li>
<li>Guide of App open source framework for Android</li>
<li>Guide of Android App push notification integration</li>
<li>Guide of Android App third-party authentication and re-skin</li>
<li>Guide of APICloud open source framework</li>
</ul>
<p>See “App Development SDK” to develop the IoT App (many user cases of design details can be found here)</p>
<ul>
<li>Guide of Gizwits Device SDK 2.0 for iOS App</li>
<li>Guide of Gizwits Device SDK 2.0 for Android App</li>
<li>Guide of Gizwits Device SDK for APICloud App</li>
<li>Explanation of SDK data transparent transmission</li>
<li>Guide of SDK debug log capture</li>
<li>SDK error codes</li>
</ul>
<p>More application development guides</p>
<ul>
<li>Application development FAQ</li>
<li>Device sharing guide</li>
<li>Application process for third-party authentication platform </li>
</ul>

    </div>
    
    <div class="widget-wrapper">
  <span class="widget">
    <div>
        <a id="share" target="_blank" title="Share">
          <span>Share</span>
        </a>
        <div class="social-share" data-initialized="true">
            <a href="#" class="social-share-icon icon-wechat"></a>
            <a href="#" class="social-share-icon icon-weibo"></a>
            <a href="#" class="social-share-icon icon-qq"></a>
            <a href="#" class="social-share-icon icon-qzone"></a>
            <a href="#" class="social-share-icon icon-douban"></a>
        </div>
    </div>
    <a href="http://y0.cn/docs" target="_blank" title="Register">
      <span>Register</span>
    </a>
    <a href="https://github.com/gizwits-docs/gizwits-docs/issues" target="_blank" title="Feed back">
      <span>Feed back</span>
    </a>
    <a href="#" title="Top"><i class="fa fa-angle-up fa-2x" aria-hidden="true"></i></a>
  </span>
</div>
  </div>
</div>

    <div class="footer">
  <div class="container">
    <p>
      <span><a href="http://www.gizwits.com" target="_blank">HOME</a></span>
      <span><a href="http://www.gizwits.com/about-us" target="_blank">ABOUT</a></span>
      <span><a href="http://www.gizwits.com/about-us#contact-us" target="_blank">CONTACT</a></span>
      <span><a href="http://www.gizwits.com/join-us" target="_blank">JOIN</a></span>
    </p>
    <p>&#169;2011-2017; Gizwits IoT Technology Co., Ltd. 粤ICP备11090211号</p>
  </div>
</div>

    <script src="/js/spin.min.js"></script>
<script src="/js/jquery.min.js"></script>
<script src="/js/jquery.hashchange.min.js"></script>
<script src="/js/clipboard.min.js"></script>
<script src="/js/scrollspy.js"></script>
<script src="/js/social-share.min.js"></script>
<script src="/js/documentation.js?v=d413cf8ceca4865c39c2dabcd3bc0077"></script>


<script type="text/javascript" src="http://webchat.7moor.com/javascripts/7moorInit.js?accessId=b01e0430-943a-11e6-8ad7-636675d9e71f&autoShow=true" async="async"></script>


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?3787e6b3b29a084fde41f22828d89b7d";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>
  </body>
</html>