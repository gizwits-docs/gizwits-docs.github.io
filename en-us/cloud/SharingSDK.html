
<!DOCTYPE html>
<html lang="en-us">
  <head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">

  <title>Guide to Gizwits Device Sharing - Gizwits</title>

  <meta http-equiv="X-UA-Compatible" content="IE=Edge, chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <meta name="Description" content="Guide to Gizwits Device Sharing-Gizwits">
  <meta name="keywords" content="Guide to Gizwits Device Sharing docs 文档中心 Gizwits">

  <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon">
  <script src="/js/redirect.js"></script>

  <link rel="stylesheet" href="/css/pure.min.css">
  <link rel="stylesheet" href="/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/documentation.css?v=db6111caa3d210b6cb1d2dac5119d7c5">
  <link rel="stylesheet" href="/css/share.min.css">
</head>
  <body>
    <div class="header">
  <div class="container pure-g">
    <span class="brand pure-u-5-24">
      <a href="http://www.gizwits.com" class="logo">
      
      <img src="/images/logo_en.png" alt="logo">
      
      </a>
      <a class="text" href="/">Docs</a>
    </span>

    <div class="mobile-header" v="">
      <span class="title">Gizwits Docs</span>
      <i class="fa fa-caret-square-o-down fa-lg" aria-hidden="true"></i>
    </div>

    <span class="menu pure-u-16-24">
      <span class="header-search-btn" id="header-search-btn">
        <i class="fa fa-search"></i>
      </span>
      <ul class="levelA-wrapper">
        
          
            <li class="levelA"><a href="/en-us/overview/overview.html">Overview</a></li>
          
        
          
            <li class="levelA">
              Quick Start &#9662;
              <ul class="levelB-wrapper">
                
                  
                    <li class="levelB"><a href="/en-us/quickstart/GizwitsQuickStart.html">Gizwits Quick Start in 5 mins</a></li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/quickstart/glossary.html">Glossary</a></li>
                  
                
              </ul>
            </li>
          
        
          
            <li class="levelA">
              App Dev Guide &#9662;
              <ul class="levelB-wrapper">
                
                  
                    <li class="levelB"><a href="/en-us/quickstart/AppDevPrepare.html">App development preparation and guidance</a></li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/UserManual/devApp.html">App code auto-generator</a></li>
                  
                
                  
                    <li class="levelB has-submenu">
                      APP Frame Guide &#9656;
                      <ul class="levelC-wrapper">
                        
                          <li class="levelC"><a href="/en-us/AppDev/iOSPushNotification.html">iOS Push Notification</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/iOSAuthReSkin.html">iOS Auth Re Skin</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/iosframe.html">Quick start of iOS App development</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/androidframe.html">Android frame</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/AndroidPushNotification.html">Android Push Notification</a></li>
                        
                          <li class="levelC"><a href="/en-us/quickstart/AndroidAppFrame.html">Quick start of Android App development</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/APICloudFrame.html">API Cloud Frame</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/VideoTutorial.html">Video tutorial of the App open source framework</a></li>
                        
                      </ul>
                    </li>
                  
                
                  
                    <li class="levelB has-submenu">
                      App SDK Guide &#9656;
                      <ul class="levelC-wrapper">
                        
                          <li class="levelC"><a href="/en-us/AppDev/iOSSDKA2.html">iOS SDK</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/AndroidSDKA2.html">Android SDK</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/APICloudWifiSDK.html">APICloud SDK</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/SDKTransparentTransmission.html">Data transparent transmission of SDK</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/SDKLogCapture.html">SDK debug log capture</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/sdk_error.html">SDK error codes</a></li>
                        
                      </ul>
                    </li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/WechatDev/WeChatDev.html">WeChat SDK Guide</a></li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/WechatDev/WechatDevIntro.html">WeChat Dev Intro</a></li>
                  
                
                  
                    <li class="levelB has-submenu">
                      More Guide &#9656;
                      <ul class="levelC-wrapper">
                        
                          <li class="levelC"><a href="/en-us/cloud/SharingSDK.html">Gizwits Device Sharing</a></li>
                        
                          <li class="levelC"><a href="/en-us/AppDev/third-party.html">Application process for third-party authentication</a></li>
                        
                      </ul>
                    </li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/AppDev/AppDevFAQ.html">App Dev FAQ</a></li>
                  
                
              </ul>
            </li>
          
        
          
            <li class="levelA">
              DeviceDev &#9662;
              <ul class="levelB-wrapper">
                
                  
                    <li class="levelB"><a href="/en-us/DeviceDev/DeviceDevIntro.html">Get started with device connection</a></li>
                  
                
                  
                    <li class="levelB has-submenu">
                      Gizwits Cloud access &#9656;
                      <ul class="levelC-wrapper">
                        
                          <li class="levelC"><a href="/en-us/quickstart/UseMCU.html">MCU scheme</a></li>
                        
                          <li class="levelC"><a href="/en-us/DeviceDev/UseSOC.html">ESP8266-SoC scheme</a></li>
                        
                      </ul>
                    </li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/module_source/module_source.html">Module Documents</a></li>
                  
                
                  
                    <li class="levelB has-submenu">
                      GAgent Documents &#9656;
                      <ul class="levelC-wrapper">
                        
                          <li class="levelC"><a href="/en-us/DeviceDev/gagent_info.html">Detailed annotation of GAgent</a></li>
                        
                          <li class="levelC"><a href="/en-us/DeviceDev/DebugTool.html">Firmware downloading on modules</a></li>
                        
                          <li class="levelC"><a href="/en-us/DeviceDev/debug/HF-LPB100.html">HF-LPB100</a></li>
                        
                          <li class="levelC"><a href="/en-us/DeviceDev/debug/HF-LPT120.html">HF-LPT120</a></li>
                        
                          <li class="levelC"><a href="/en-us/DeviceDev/debug/MXCHIP.html">MXCHIP</a></li>
                        
                          <li class="levelC"><a href="/en-us/DeviceDev/debug/ESP8266.html">ESP8266</a></li>
                        
                      </ul>
                    </li>
                  
                
              </ul>
            </li>
          
        
          
            <li class="levelA">
              Cloud API &#9662;
              <ul class="levelB-wrapper">
                
                  
                    <li class="levelB"><a href="/en-us/cloud/OpenAPI.html">Open API</a></li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/cloud/ent_dev.html">Enterprise Application Development</a></li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/cloud/enterprise_api.html">Enterprise API</a></li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/cloud/NotificationAPI.html">Notification API</a></li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/cloud/WebsocketAPI.html">WebsocketAPI</a></li>
                  
                
                  
                    <li class="levelB has-submenu">
                      API Tutorial &#9656;
                      <ul class="levelC-wrapper">
                        
                          <li class="levelC"><a href="/en-us/UserManual/UseOpenAPI.html">Using Open API to control virtual device with Postman</a></li>
                        
                          <li class="levelC"><a href="/en-us/UserManual/UseSNoti.html">Real-time data synchronization demo for SNoti service</a></li>
                        
                          <li class="levelC"><a href="/en-us/UserManual/UseWebsocket.html">Control device using WebSocket</a></li>
                        
                          <li class="levelC"><a href="/en-us/UserManual/DataAPI.html">Aggregation API Guide</a></li>
                        
                          <li class="levelC"><a href="/en-us/UserManual/LinkageAPI.html">Device Linkage API Tutorial</a></li>
                        
                          <li class="levelC"><a href="/en-us/UserManual/devgroup_API.html">Device Grouping API Tutorial</a></li>
                        
                          <li class="levelC"><a href="/en-us/UserManual/UseQRCode.html">Generating device QR code for App binding</a></li>
                        
                      </ul>
                    </li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/cloud/CloudFAQ.html">Cloud FAQ</a></li>
                  
                
              </ul>
            </li>
          
        
          
            <li class="levelA">
              User Manual &#9662;
              <ul class="levelB-wrapper">
                
                  
                    <li class="levelB"><a href="/en-us/UserManual/ST_IoT.html">Gizwits and ST Make IoT Development Easy</a></li>
                  
                
                  
                    <li class="levelB"><a href="/en-us/DeviceDev/ST/ICUBEGIZWITS.html">Getting Started with I-CUBE-GiZWITS</a></li>
                  
                
              </ul>
            </li>
          
        
      </ul>
    </span>

    <span class="pure-u-3-24 lang-switch-wrapper">

      <i class="fa fa-globe" aria-hidden="true"></i>
      
      <a href="/zh-cn/overview/overview.html" class="lang-switch" data-lang="zh-cn">中文</a>
      
    </span>
  </div>

  <div class="header-search-panel" id="header-search-panel">
    <span class="header-search-close" id="header-search-close"><i class="fa fa-times" aria-hidden="true"></i></span>
    <div class="header-search-input-wrap" id="header-search-input-wrap">
      <input type="text" class="header-search-input" id="header-search-input" placeholder="请输入关键字">
      <span class="header-search-input-icon"><i class="fa fa-search"></i></span>
    </div>

    <div class="header-search-trend" id="header-search-trend">
      <div class="header-search-trend-title">热搜词</div>
      <div class="header-search-trend-items clearfix">
        
        <div class="header-search-trend-item" data-word="APP">APP</div>
        
        <div class="header-search-trend-item" data-word="SDK">SDK</div>
        
        <div class="header-search-trend-item" data-word="Android">Android</div>
        
        <div class="header-search-trend-item" data-word="ios">ios</div>
        
        <div class="header-search-trend-item" data-word="WIFI">WIFI</div>
        
      </div>
    </div>

    <div class="header-search-result hidden" id="header-search-result">
      <div class="header-search-result-head">
        搜索结果 &gt; <span id="header-search-keyword"></span>
      </div>
      <div class="header-search-result-items" id="header-search-result-items">
      </div>
    </div>
  </div>
</div>

    <div class="body">

  <div class="container clearfix">
    <div class="navigation">
      <div class="navigation-inner">
        <div class="nav-title">Content</div>
        <div class="nav"></div>
      </div>
    </div>
    <div class="markdown-body" data-spy="scroll" data-target=".navigation">
      <div class="heading">
        <div class="title">Guide to Gizwits Device Sharing</div>
        <a class="edit-link" target="_blank"><i class="fa fa-github" aria-hidden="true"></i> Edit</a>
      </div>
      <h1 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h1><p>After binding a device, you can let others use the device through Device Sharing. In order to facilitate multiple customers use the same device, device sharing provides device permission management with a more secure and convenient device binding. There are four types of device permissions for device binding:</p>
<ul>
<li>Owner: The primary account of the device, who can share the device;</li>
<li>Guest: The guest account of the device, who can accept the sharing invitation and can no longer share the device to other users;</li>
<li>Special: The account who has bound to the device at the earliest but has not shared the device, and will become the Owner of the device after sharing it;</li>
<li>Normal: The account that has bound to the device but cannot share the device or become the Owner of the device.</li>
</ul>
<p>Only the user bound to a device at the earliest or the Owner of a device can share the device. Once a device has an Owner account, other users can no longer bind the device. The Owner can view the currently users bound to the device and can unbind other users. When a device does not have an Owner, other users can bind the device.</p>
<p>Note: Before using Device Sharing feature, it needs to be enabled in the Developer Center - Product Basics.</p>
<p><img src="../../../assets/en-us/cloud/share/11.png" alt="Device Sharing"></p>
<h1 id="2-Scenarios-of-Device-Sharing"><a href="#2-Scenarios-of-Device-Sharing" class="headerlink" title="2. Scenarios of Device Sharing"></a>2. Scenarios of Device Sharing</h1><p>The process flowchart is as follows.</p>
<p><img src="../../../assets/en-us/cloud/share/12.png" alt="Device Sharing"></p>
<h2 id="2-1-Scenario-1-One-device-to-one-user"><a href="#2-1-Scenario-1-One-device-to-one-user" class="headerlink" title="2.1 Scenario 1: One device to one user"></a>2.1 Scenario 1: One device to one user</h2><p>A device can only be bound and controlled by one user, which means that the user only needs the roles of Special / Owner and does not have the roles of Normal / Guest. The code flowchart is as follows:</p>
<p><img src="../../../assets/en-us/cloud/share/13.png" alt="Device Sharing"></p>
<p>Note: Because this scenario is for one device to one user, when the user with Special role calls the device sharing function to become the Owner role, the guestUser parameter of the sharingDevice method is just set to a user account registered using the appid without UI involved.</p>
<h2 id="2-2-Scenario-2-One-device-to-multi-users"><a href="#2-2-Scenario-2-One-device-to-multi-users" class="headerlink" title="2.2 Scenario 2: One device to multi-users"></a>2.2 Scenario 2: One device to multi-users</h2><p>This is a common scenario. A device can be bound by multiple users. When a Special user becomes the Owner and other users want bind the device, the Owner user can share the device to other users by calling the device sharing function, and then other users can remotely control the device. That is to say, the users involved can have roles of Special / Owner or Normal / Guest. The code flowchart is as follows:</p>
<p>(1) Create a sharing invitation</p>
<p><img src="../../../assets/en-us/cloud/share/14.png" alt="Device Sharing"> </p>
<p>(2) Receive a sharing invitation</p>
<p><img src="../../../assets/en-us/cloud/share/15.png" alt="Device Sharing"> </p>
<h1 id="3-Hardware-design"><a href="#3-Hardware-design" class="headerlink" title="3. Hardware design"></a>3. Hardware design</h1><h2 id="3-1-Introduction-to-the-Bindable-Mode"><a href="#3-1-Introduction-to-the-Bindable-Mode" class="headerlink" title="3.1 Introduction to the Bindable Mode"></a>3.1 Introduction to the Bindable Mode</h2><p>When the Wi-Fi module requests the device information, the MCU reply contains a binding timeout field. When the field value is 0, the device can be bound at any time in the WLAN. If it is greater than 0, the commands in the protocol document 4.12 MCU notify the Wi-Fi module to enter the bindable mode can be used.</p>
<p><img src="../../../assets/en-us/cloud/share/16.png" alt="Device Sharing"></p>
<p><img src="../../../assets/en-us/cloud/share/17.png" alt="Device Sharing"></p>
<h2 id="3-2-Why-Device-Sharing-should-be-used-together-with-Device-Binding-timeout"><a href="#3-2-Why-Device-Sharing-should-be-used-together-with-Device-Binding-timeout" class="headerlink" title="3.2 Why Device Sharing should be used together with Device Binding timeout"></a>3.2 Why Device Sharing should be used together with Device Binding timeout</h2><p>In a WLAN, when a user becomes the device Owner via the device sharing function, other users in the WLAN can discover and control the device through Device Discovery API, but cannot bind the device merely.<br>In the case of Macro Cycle, the users who has previously bound the device, except the Owner, cannot discover the device via calling the API of getting the bound device list. Other uses can control the device only when it is shared by the Owner.</p>
<h2 id="3-3-Reset-Wi-Fi-module"><a href="#3-3-Reset-Wi-Fi-module" class="headerlink" title="3.3 Reset Wi-Fi module"></a>3.3 Reset Wi-Fi module</h2><p>After the device module is reset, it clears the previously configured SSID, password, did, passcode, etc., and all binding relationships of the device.</p>
<p><img src="../../../assets/en-us/cloud/share/18.png" alt="Device Sharing"></p>
<h2 id="3-4-Why-Device-Sharing-needs-the-Wi-Fi-module-reset-sometimes"><a href="#3-4-Why-Device-Sharing-needs-the-Wi-Fi-module-reset-sometimes" class="headerlink" title="3.4 Why Device Sharing needs the Wi-Fi module reset sometimes"></a>3.4 Why Device Sharing needs the Wi-Fi module reset sometimes</h2><p>When the device Owner or Special role is set to other users who are unidentified, the information of all users who have previously bound to the device will be cleared after the device module reset including the previous Owner or Special. Once the customer reconfigures and binds the device, he will have the Special role, then share the device, he will become the Owner again.</p>
<h1 id="4-App-development"><a href="#4-App-development" class="headerlink" title="4. App development"></a>4. App development</h1><h2 id="4-1-Android-SDK"><a href="#4-1-Android-SDK" class="headerlink" title="4.1 Android SDK"></a>4.1 Android SDK</h2><h3 id="4-1-1-Device-Sharing-via-user-ID"><a href="#4-1-1-Device-Sharing-via-user-ID" class="headerlink" title="4.1.1 Device Sharing via user ID"></a>4.1.1 Device Sharing via user ID</h3><p>For Device Sharing via user ID, the receiver’s ID can be a mobile phone number, an email address, a regular user name, or an anonymous ID, but it must be a user who has already registered in Gizwits Cloud. If the user is already the Guest of this device or has already bound the device, the sharing invitation will fail to be created. The sharing invitation is valid for 24 hours, that is, the receiver must respond within 24 hours, otherwise the invitation will expire. </p>
<p>Note: If the scenario is one device to one user, the guestUser parameter of the sharingDevice method is just set to a user account registered using the appid without UI involved. For details, see 2.1 Scenario 1: One device to one user.</p>
<p>You need to specify the user ID type. The guestUser parameter for the anonymous user should be set to the uid of the anonymous user. When the Account Sharing is created successfully, the sharingID will be returned in the callback parameter, but the QRCodeImage will not be returned. The following is only an example of device sharing to a user registered with mobile phone number:</p>
<p>[Code sample]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">// Set device sharing listener</span><br><span class="line">GizDeviceSharing.setListener(mListener);</span><br><span class="line"></span><br><span class="line">// Find devices that can be shared in the device list</span><br><span class="line"></span><br><span class="line">// Share the device via phone number</span><br><span class="line">GizDeviceSharing.sharingDevice(&quot;your_token&quot;, &quot;your_device_id&quot;, GizDeviceSharingWay.GizDeviceSharingByNormal, &quot;guest_phone_number&quot;, GizUserAccountType.GizUserPhone);</span><br><span class="line"></span><br><span class="line">GizDeviceSharingListener mListener = new GizDeviceSharingListener() &#123;</span><br><span class="line"> </span><br><span class="line">    @Override</span><br><span class="line">    public void didSharingDevice(GizWifiErrorCode result, String deviceID, int sharingID, Bitmap QRCodeImage) &#123;</span><br><span class="line">        if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) &#123;</span><br><span class="line">            // Success</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            // Failure</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">### 4.1.2 Device Sharing via QR code</span><br><span class="line"></span><br><span class="line">For the Device Sharing via QR code, the QR code is valid for 15 minutes, that is, the receiver must scan the generated QR code within 15 minutes and respond, otherwise the QR code invitation will expire. When the QR code Sharing invitation is created successfully, the sharingID will be returned in the callback parameter, and the corresponding QRCodeImage will also be returned. The App can directly load the QR code image.</span><br><span class="line"></span><br><span class="line">[Code sample]</span><br></pre></td></tr></table></figure>
<p>// Set device sharing listener<br>GizDeviceSharing.setListener(mListener);</p>
<p>// Find devices that can be shared in the device list</p>
<p>// Share the device via QR code<br>GizDeviceSharing.sharingDevice(“your_token”, “your_device_id”, GizDeviceSharingWay.GizDeviceSharingByQRCode, null, null);</p>
<p>GizDeviceSharingListener mListener = new GizDeviceSharingListener() {</p>
<pre><code>@Override
public void didSharingDevice(GizWifiErrorCode result, String deviceID, int sharingID, Bitmap QRCodeImage) {
    if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) {
        // Success
    } else {
        // Failure
    }
}
</code></pre><p>};<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 4.1.3 Accept sharing invitation</span><br><span class="line"></span><br><span class="line">The Guest account can query the received sharing invitations. Only the Guest account can accept the sharing invitation.</span><br><span class="line"></span><br><span class="line">If a sharing invitation received by the Guest has not yet been accepted, the Guest can accept or reject it.</span><br><span class="line"></span><br><span class="line">[Code sample]</span><br></pre></td></tr></table></figure></p>
<p>// Set device sharing listener<br>GizDeviceSharing.setListener(mListener);</p>
<p>// Query the list of sharing invitations sent to you<br>GizDeviceSharing.getDeviceSharingInfos(“your_token”, GizDeviceSharingType.GizDeviceSharingToMe, “your_device_id”);</p>
<p>GizDeviceSharingListener mListener = new GizDeviceSharingListener() {</p>
<pre><code>@Override
public void didGetDeviceSharingInfos(GizWifiErrorCode result, String deviceID, List&lt;GizDeviceSharingInfo&gt; deviceSharingInfos) {
    if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) {

        // Successfully retrieved. Find the share invitations that have not yet been accepted in deviceSharingInfos. your_sharing_id is the ID of the share invitation to be acceptted
        int your_sharing_id = -1;
        for (int i = 0; i &lt; deviceSharingInfos.size(); i++) {
            GizDeviceSharingInfo mDeviceSharing = deviceSharingInfos.get(i);
            if (mDeviceSharing.getStatus() == GizDeviceSharingStatus.GizDeviceSharingNotAccepted) {
                your_sharing_id = mDeviceSharing.getId();
                break;
            }
        }

        // Accept invitation
        if (your_sharing_id != -1) {
            GizDeviceSharing.acceptDeviceSharing(&quot;your_token&quot;, your_sharing_id, true);
        }

    } else {
        // Failed to retrieve
    }
}


@Override
public void didAcceptDeviceSharing(GizWifiErrorCode result, int sharingID) {
    if (result == GizWifiErrorCode.GIZ_SDK_SUCCESS) {
        // Success
    } else {
        // Failure
    }
}
</code></pre><p>};<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 4.2 iOS SDK</span><br><span class="line"></span><br><span class="line">### 4.2.1 Device Sharing via user ID</span><br><span class="line"></span><br><span class="line">For Device Sharing via user ID, the receiver&apos;s ID can be a mobile phone number, an email address, a regular user name, or an anonymous ID, but it must be a user who has already registered in Gizwits Cloud. If the user is already the Guest of this device or has already bound the device, the sharing invitation will fail to be created. The sharing invitation is valid for 24 hours, that is, the receiver must respond within 24 hours, otherwise the invitation will expire. </span><br><span class="line"></span><br><span class="line">Note: If the scenario is one device to one user, the guestUser parameter of the sharingDevice method is just set to a user account registered using the appid without UI involved. For details, see 2.1 Scenario 1: One device to one user.</span><br><span class="line"></span><br><span class="line">You need to specify the user ID type. The guestUser parameter for the anonymous user should be set to the uid of the anonymous user. When the Account Sharing is created successfully, the sharingID will be returned in the callback parameter, but the QRCodeImage will not be returned. The following is only an example of device sharing to a user registered with mobile phone number:</span><br><span class="line"></span><br><span class="line">[Code sample]</span><br></pre></td></tr></table></figure></p>
<p>// Set a device sharing delegate<br>[GizDeviceSharing setDelegate:self];</p>
<p>// Find devices that can be shared in the device list</p>
<p>// Share the device to a user registered with mobile phone number<br>[GizDeviceSharing sharingDevice:@”your_token” deviceID: @”your_device_id” sharingWay:GizDeviceSharingByNormal guestUser:@”guest_phone_number” guestUserType:GizUserPhone]; </p>
<p>// Callback</p>
<ul>
<li>(void)didSharingDevice:(NSError<em>)result deviceID:(NSString</em>)deviceID sharingID:(NSInteger)sharingID QRCodeImage:(UIImage*)QRCodeImage {<br>  if(result.code == GIZ_SDK_SUCCESS) {<pre><code>// success
</code></pre>  } else {<pre><code>// failure
</code></pre>  }<br>}<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 4.2.2 Device Sharing via QR code</span><br><span class="line"></span><br><span class="line">For the Device Sharing via QR code, the QR code is valid for 15 minutes, that is, the receiver must scan the generated QR code within 15 minutes and respond, otherwise the QR code invitation will expire. When the QR code Sharing invitation is created successfully, the sharingID will be returned in the callback parameter, and the corresponding QRCodeImage will also be returned. The App can directly load the QR code image.</span><br><span class="line"></span><br><span class="line">[Code sample]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>// Set a device sharing delegate<br>[GizDeviceSharing setDelegate:self];</p>
<p>// Find devices that can be shared in the device list</p>
<p>// Share the device through QR code Sharing<br>[GizDeviceSharing sharingDevice:@”your_token” deviceID: @”your_device_id” sharingWay:GizDeviceSharingByQRCode guestUser:nil guestUserType:GizUserOther]; </p>
<p>// Callback</p>
<ul>
<li>(void)didSharingDevice:(NSError<em>)result deviceID:(NSString</em>)deviceID sharingID:(NSInteger)sharingID QRCodeImage:(UIImage*)QRCodeImage {<br>  if(result.code == GIZ_SDK_SUCCESS) {<pre><code>// success
</code></pre>  } else {<pre><code>// failure
</code></pre>  }<br>}<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 4.2.3 Accept sharing invitation</span><br><span class="line"></span><br><span class="line">The Guest account can query the received sharing invitations. Only the Guest account can accept the sharing invitation.</span><br><span class="line"></span><br><span class="line">If a sharing invitation received by the Guest has not yet been accepted, the Guest can accept or reject it.</span><br><span class="line"></span><br><span class="line">[Code sample]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>// Set a device sharing delegate<br>[GizDeviceSharing setDelegate:self];</p>
<p>// Query the received sharing invitations<br>[GizDeviceSharing getDeviceSharingInfos:@”your_token” sharingType: GizDeviceSharingToMe deviceID: @”your_device_id”];</p>
<p>// Callback for getting the invitation list </p>
<ul>
<li><p>(void)didGetDeviceSharingInfos:(NSError<em>)result deviceID:(NSString</em>)deviceID deviceSharingInfos:(NSArray*)deviceSharingInfos {<br>  if(result.code == GIZ_SDK_SUCCESS) {</p>
<pre><code>// Get the invitation list successfully. Find the unaccepted sharing invitations in deviceSharingInfos, and your_sharing_id represents the sharing invitation to be accepted
NSInteger your_sharing_id = -1;
for (int i = 0; i &lt; deviceSharingInfos.count; i++) {
    GizDeviceSharingInfo* mDeviceSharing = [deviceSharingInfos objectAtIndex:i];
    if (mDeviceSharing.status == GizDeviceSharingNotAccepted) {
        your_sharing_id = mDeviceSharing.id;
        break;
    }
}

// Accept the invitation
if (your_sharing_id != -1) {
    [GizDeviceSharing acceptDeviceSharing:@&quot;your_token&quot; sharingID:your_sharing_id accept:YES];
}
</code></pre><p>  } else {</p>
<pre><code>// Fail to get the invitation list
</code></pre><p>  }<br>}</p>
</li>
</ul>
<p>// Callback for accepting the sharing invitation    </p>
<ul>
<li>(void)didAcceptDeviceSharing:(NSError*)result sharingID:(NSInteger)sharingID {<br>  if(result.code == GIZ_SDK_SUCCESS) {<pre><code>// success
</code></pre>  } else {<pre><code>// failure
</code></pre>  }<br>}<br><code>`</code></li>
</ul>
<h1 id="5-Reference"><a href="#5-Reference" class="headerlink" title="5. Reference"></a>5. Reference</h1><ul>
<li>Guide to Gizwits Device SDK 2.0 for Android App: <a href="http://docs.gizwits.com/zh-cn/AppDev/AndroidSDKA2.html" target="_blank" rel="noopener">http://docs.gizwits.com/zh-cn/AppDev/AndroidSDKA2.html</a></li>
<li>Guide to Gizwits Device SDK 2.0 for iOS App: <a href="http://docs.gizwits.com/zh-cn/AppDev/iOSSDKA2.html" target="_blank" rel="noopener">http://docs.gizwits.com/zh-cn/AppDev/iOSSDKA2.html</a></li>
</ul>

    </div>
    
    <div class="widget-wrapper">
  <span class="widget">
    <div>
        <a id="share" target="_blank" title="Share">
          <span>Share</span>
        </a>
        <div class="social-share" data-initialized="true">
            <a href="#" class="social-share-icon icon-wechat"></a>
            <a href="#" class="social-share-icon icon-weibo"></a>
            <a href="#" class="social-share-icon icon-qq"></a>
            <a href="#" class="social-share-icon icon-qzone"></a>
            <a href="#" class="social-share-icon icon-douban"></a>
        </div>
    </div>
    <a href="http://y0.cn/docs" target="_blank" title="Register">
      <span>Register</span>
    </a>
    <a href="https://github.com/gizwits-docs/gizwits-docs/issues" target="_blank" title="Feed back">
      <span>Feed back</span>
    </a>
    <a href="#" title="Top"><i class="fa fa-angle-up fa-2x" aria-hidden="true"></i></a>
  </span>
</div>
  </div>
</div>

    <div class="footer">
  <div class="container">
    <p>
      <span><a href="http://www.gizwits.com" target="_blank">HOME</a></span>
      <span><a href="http://www.gizwits.com/about-us" target="_blank">ABOUT</a></span>
      <span><a href="http://www.gizwits.com/about-us#contact-us" target="_blank">CONTACT</a></span>
      <span><a href="http://www.gizwits.com/join-us" target="_blank">JOIN</a></span>
    </p>
    <p>&#169;2011-2017; Gizwits IoT Technology Co., Ltd. 粤ICP备11090211号</p>
  </div>
</div>

    <script src="/js/spin.min.js"></script>
<script src="/js/jquery.min.js"></script>
<script src="/js/jquery.hashchange.min.js"></script>
<script src="/js/clipboard.min.js"></script>
<script src="/js/scrollspy.js"></script>
<script src="/js/social-share.min.js"></script>
<script src="/js/documentation.js?v=d413cf8ceca4865c39c2dabcd3bc0077"></script>


<script type="text/javascript" src="http://webchat.7moor.com/javascripts/7moorInit.js?accessId=b01e0430-943a-11e6-8ad7-636675d9e71f&autoShow=true" async="async"></script>


<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?3787e6b3b29a084fde41f22828d89b7d";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>
  </body>
</html>